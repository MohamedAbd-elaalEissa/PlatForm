import{c as ye,e as ae,f as re,j as ke,k as Ve,m as Ze,n as $e,o as et,r as tt,s as it}from"./chunk-HI2TDCOG.js";import{b as Qe}from"./chunk-YPK5KGQ4.js";import{a as at,b as rt,c as K,d as Y,e as E,f as Me}from"./chunk-D6C5HRHS.js";import{c as G,d as H,f as Xe,h as nt,i as ot,j as Te,k as Ie}from"./chunk-ONA3RLDT.js";import{$ as Se,A as te,B as ie,G as Je,L as ne,Q as be,_ as oe,y as Ye,z as qe}from"./chunk-WWXKWVPM.js";import"./chunk-LCP6WAMI.js";import{Ab as $,Fb as he,Ga as ge,Gb as ee,Hb as ve,Ib as xe,Jb as j,Ka as D,Kb as Ce,Lb as we,Mb as U,Nb as R,Oa as fe,Xa as Ke,_a as L,ab as A,db as N,hb as P,i as me,n as Ge,o as He,p as ce,q as ue,v as _e,zb as Z}from"./chunk-EIK6HXDD.js";import{Bb as J,Hb as o,Ib as r,Jb as g,Nb as S,Pb as f,Qb as d,Ta as W,Uc as O,Vc as X,Ya as s,Za as b,ac as q,bc as m,bd as M,cc as k,dc as Q,e as je,fc as x,gc as C,hc as w,ic as z,jb as I,jc as V,la as c,ma as u,qb as h,xc as v,yb as p}from"./chunk-OT2PUON7.js";var _t=()=>["/pages/teachers/videos-and-tasks/studentTasksDashboard"],gt=()=>({width:"100%",height:"100%"});function ft(n,i){if(n&1){let e=S();o(0,"div",4)(1,"p-floatlabel",5)(2,"input",6),w("ngModelChange",function(t){c(e);let l=d();return C(l.Filter.taskName,t)||(l.Filter.taskName=t),u(t)}),f("ngModelChange",function(){c(e);let t=d();return u(t.onFilterChange())}),r(),o(3,"label",7),g(4,"p-inputicon",8),m(5," \u0627\u0633\u0645 \u0627\u0644\u062A\u0627\u0633\u0643"),r()(),o(6,"p-floatlabel",9)(7,"p-dropdown",10),w("ngModelChange",function(t){c(e);let l=d();return C(l.Filter.academicLevelId,t)||(l.Filter.academicLevelId=t),u(t)}),f("ngModelChange",function(){c(e);let t=d();return u(t.onFilterChange())}),r(),o(8,"label",11),m(9,"\u0627\u0644\u0645\u0631\u062D\u0644\u0629 \u0627\u0644\u062F\u0631\u0627\u0633\u064A\u0629"),r()()(),o(10,"div",12)(11,"p-checkbox",13),w("ngModelChange",function(t){c(e);let l=d();return C(l.Filter.isBook,t)||(l.Filter.isBook=t),u(t)}),f("ngModelChange",function(){c(e);let t=d();return u(t.onFilterChange())}),r(),o(12,"label",14),m(13,"Is Book "),r()()}if(n&2){let e=d();s(2),x("ngModel",e.Filter.taskName),s(5),x("ngModel",e.Filter.academicLevelId),p("options",e.academicLevelData),s(4),x("ngModel",e.Filter.isBook),p("binary",!0)}}function ht(n,i){if(n&1){let e=S();o(0,"div",17)(1,"div",18)(2,"div",19)(3,"div",20),g(4,"img",21),r()(),o(5,"div",22)(6,"div",23)(7,"div")(8,"span",24),m(9,"PDF"),r(),o(10,"div",25),m(11),r()()(),o(12,"div",26),g(13,"button",27),r(),o(14,"div",28)(15,"button",29),f("click",function(){let t=c(e).$implicit,l=d(2);return u(l.downloadTask(t.fileName))}),r(),o(16,"div",30)(17,"p-fileUpload",31),f("uploadHandler",function(t){let l=c(e).$implicit,_=d(2);return u(_.uploadTask(t,l.filesID,_.studentId,l.teacherID,!0,l.academicLevelID,l.taskName,l.taskName+"Answer"))}),r()()()()()()}if(n&2){let e=i.$implicit;s(4),p("src","assets/File/PDFile.png",W)("alt","PDF"),s(7),k(e.taskName),s(2),p("outlined",!e.isAnswer)("routerLink",V(10,_t)),s(4),J(V(11,gt)),p("auto",!0)("disabled",!1)("accept","application/pdf")}}function vt(n,i){if(n&1&&(o(0,"div",15),h(1,ht,18,12,"div",16),r()),n&2){let e=d();s(),p("ngForOf",e.tasksFiles)}}var Fe=class n{constructor(i,e,a,t){this.tasksAndVideos=i;this.route=e;this.messageService=a;this.router=t;let l=sessionStorage.getItem("teacherId");l&&(this.teacherId=+l);let _=sessionStorage.getItem("chapterId");_&&(this.chapterId=+_)}teacherId;chapterId;tasksFiles=[];studentId=3;academicLevelId=4;Filter;academicLevelData=[];layout="list";options=["list","grid"];ngOnInit(){this.Filter={teacherId:this.teacherId,chapterId:this.chapterId,academicLevelId:this.academicLevelId,pageNumber:1,pageSize:25},this.getPDFiles(),this.getAcademicLevelFilter()}getPDFiles(){this.tasksAndVideos.getTeachersFiles(this.Filter).subscribe({next:i=>{this.tasksFiles=i.items},error:i=>{console.error("Error fetching teachers:",i)}})}getAcademicLevelFilter(){this.tasksAndVideos.getAllAcademicLevels().subscribe({next:i=>{this.academicLevelData=i}})}downloadTask(i){this.tasksAndVideos.downloadFile(i).subscribe({next:e=>{let a=new Blob([e.body],{type:e.body?.type}),t=e.headers.get("Content-Disposition"),l=i;if(t){let F=t.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/);F&&F[1]&&(l=F[1].replace(/['"]/g,""))}let _=window.URL.createObjectURL(a),T=document.createElement("a");T.href=_,T.download=l,T.click(),window.URL.revokeObjectURL(_)},error:e=>{console.error("Error downloading file:",e)}})}uploadTask(i,e,a,t,l,_,T,F){let de=i.files[0],y=new FormData;y.append("file",de),y.append("fileID",e.toString()),y.append("studentId",a?a.toString():""),y.append("teacherId",t.toString()),y.append("isAnswer",l.toString()),y.append("academicLevelID",_.toString()),y.append("taskName",T),y.append("answerName",F),this.tasksAndVideos.uploadFile(y).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Success",detail:"File uploaded successfully!"}),this.getPDFiles()},error:B=>{this.messageService.add({severity:"error",summary:"Error",detail:"Upload failed!"})}})}navigateWithFileId(i){sessionStorage.setItem("fileId",i.toString()),this.router.navigate(["/pages/teachers/videos-and-tasks/studentTasksDashboard"])}onFilterChange(){this.getPDFiles()}static \u0275fac=function(e){return new(e||n)(b(E),b(Ge),b(D),b(ce))};static \u0275cmp=I({type:n,selectors:[["app-tasks"]],features:[z([D])],decls:7,vars:2,consts:[["header",""],["grid",""],[1,"card"],[3,"layout","value"],[1,"filters-container"],["variant","on",1,"filter-item"],["pInputText","","id","taskName","autocomplete","off",2,"width","100%",3,"ngModelChange","ngModel"],["for","taskName",2,"font-size","large"],["Class","pi pi-search"],["variant","on",1,"w-full","md:w-56","filter-item"],["inputId","academicLevel","optionLabel","academicLevelName","optionValue","academicLevelID","styleClass","w-full",3,"ngModelChange","ngModel","options"],["for","academicLevel",2,"font-size","large"],[1,"CheckBox"],[3,"ngModelChange","ngModel","binary"],["for","ny",1,"ml-3"],[1,"grid","grid-cols-12","gap-4"],["class","col-span-12 sm:col-span-6 md:col-span-4 xl:col-span-6 p-2",4,"ngFor","ngForOf"],[1,"col-span-12","sm:col-span-6","md:col-span-4","xl:col-span-6","p-2"],[1,"p-6","border","border-surface-200","dark:border-surface-700","bg-surface-0","dark:bg-surface-900","rounded","flex","flex-col"],[1,"bg-surface-50","flex","justify-center","rounded","p-4"],[1,"relative","mx-auto"],[1,"rounded","w-full",2,"max-width","300px",3,"src","alt"],[1,"pt-6"],[1,"flex","flex-row","justify-between","products-start","gap-2"],[1,"font-medium","text-surface-500","dark:text-surface-400","text-sm"],[1,"text-lg","font-medium","mt-1"],[1,"flex","flex-row-reverse","gap-2","pb-4"],["pButton","","icon","pi pi-check-circle",3,"outlined","routerLink"],[1,"flex","flex-row","gap-2"],["pButton","","icon","pi pi-clipboard","label","Download Task",1,"flex-1","whitespace-nowrap",2,"height","40px",3,"click"],[1,"flex-1"],["name","file","customUpload","true","mode","basic","chooseLabel","Upload Solving","chooseIcon","pi pi-file-check",1,"whitespace-nowrap",3,"uploadHandler","auto","disabled","accept"]],template:function(e,a){e&1&&(o(0,"div",2)(1,"p-dataview",3),h(2,ft,14,5,"ng-template",null,0,v)(4,vt,2,1,"ng-template",null,1,v),r(),g(6,"p-toast"),r()),e&2&&(s(),p("layout","grid")("value",a.tasksFiles))},dependencies:[Ve,j,ve,M,O,P,L,A,N,re,ae,$,Z,_e,ue,ie,te,H,G,R,U,Y,K,we,Ce],styles:[".p-fileupload-basic{display:inline!important;width:100%!important}.filters-container[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:1rem}.filter-item[_ngcontent-%COMP%]{flex:1}.CheckBox[_ngcontent-%COMP%]{padding-bottom:10px;font-size:large;display:flex}"]})};var xt=()=>["tasks"],Ct=()=>["videos"],wt=()=>["uploadTasks"],bt=()=>["uploadVideos"],Ae=class n{constructor(){}ngOnInit(){}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=I({type:n,selectors:[["app-layout-videos-and-tasks"]],decls:19,vars:12,consts:[["value","tasks"],[3,"value","routerLink"],[1,"pi","pi-file-pdf"],[1,"pi","pi-video"],[1,"pi","pi-cloud-upload"]],template:function(e,a){e&1&&(o(0,"p-tabs",0)(1,"p-tablist")(2,"p-tab",1),g(3,"i",2),o(4,"span"),m(5,"Tasks"),r()(),o(6,"p-tab",1),g(7,"i",3),o(8,"span"),m(9,"Videos"),r()(),o(10,"p-tab",1),g(11,"i",4),o(12,"span"),m(13,"Upload Tasks"),r()(),o(14,"p-tab",1),g(15,"i",4),o(16,"span"),m(17,"Upload Videos"),r()()()(),g(18,"router-outlet")),e&2&&(s(2),p("value","tasks")("routerLink",V(8,xt)),s(4),p("value","videos")("routerLink",V(9,Ct)),s(4),p("value","uploadTasks")("routerLink",V(10,wt)),s(4),p("value","uploadVideos")("routerLink",V(11,bt)))},dependencies:[it,tt,$e,et,M,_e,He,ue],encapsulation:2})};function St(n,i){if(n&1){let e=S();o(0,"div",5)(1,"p-floatlabel",6)(2,"input",7),w("ngModelChange",function(t){c(e);let l=d();return C(l.Filter.videoName,t)||(l.Filter.videoName=t),u(t)}),f("ngModelChange",function(){c(e);let t=d();return u(t.onFilterChange())}),r(),o(3,"label",8),g(4,"p-inputicon",9),m(5," \u0627\u0633\u0645 \u0627\u0644\u0641\u062F\u064A\u0648"),r()(),o(6,"p-floatlabel",10)(7,"p-dropdown",11),w("ngModelChange",function(t){c(e);let l=d();return C(l.Filter.academicLevelId,t)||(l.Filter.academicLevelId=t),u(t)}),f("ngModelChange",function(){c(e);let t=d();return u(t.onFilterChange())}),r(),o(8,"label",12),m(9,"\u0627\u0644\u0645\u0631\u062D\u0644\u0629 \u0627\u0644\u062F\u0631\u0627\u0633\u064A\u0629"),r()()()}if(n&2){let e=d();s(2),x("ngModel",e.Filter.videoName),s(5),x("ngModel",e.Filter.academicLevelId),p("options",e.academicLevelData)}}function yt(n,i){if(n&1){let e=S();o(0,"div",15)(1,"div",16)(2,"div",17)(3,"div",18),g(4,"img",19),r()(),o(5,"div",20)(6,"div",21)(7,"div")(8,"span",22),m(9,"video"),r(),o(10,"div",23),m(11),r()()(),o(12,"div",24)(13,"div",25)(14,"button",26),f("click",function(){let t=c(e).$implicit,l=d(2);return u(l.viewVideo(t.videoName))}),r()()()()()()}if(n&2){let e=i.$implicit;s(4),p("src","assets/File/Videos3.png",W)("alt","img not fount"),s(7),k(e==null||e.videoName==null?null:e.videoName.replace(".mp4",""))}}function kt(n,i){if(n&1&&(o(0,"div",13),h(1,yt,15,3,"div",14),r()),n&2){let e=d();s(),p("ngForOf",e.videosData)}}var Ne=class n{constructor(i,e,a){this.tasksAndVideos=i;this.productService=e;this.router=a;let t=sessionStorage.getItem("teacherId");t&&(this.teacherId=t);let l=sessionStorage.getItem("chapterId");l&&(this.chapterId=+l)}academicLevelData=[];Filter;teacherId;academicLevelId=4;videosData=[];chapterId;ngOnInit(){this.Filter={teacherId:this.teacherId,chapterId:this.chapterId,academicLevelId:this.academicLevelId,pageNumber:1,pageSize:25},this.getVideos(),this.getAcademicLevelFilter()}getAcademicLevelFilter(){this.tasksAndVideos.getAllAcademicLevels().subscribe({next:i=>{this.academicLevelData=i}})}onFilterChange(){this.getVideos()}getVideos(){this.tasksAndVideos.getTeachersVideos(this.Filter).subscribe({next:i=>{this.videosData=i.items},error:i=>{console.error("Error fetching teachers:",i)}})}viewVideo(i){sessionStorage.setItem("videoName",i),this.router.navigate(["/pages/teachers/videos-and-tasks/VideoPlayer"])}static \u0275fac=function(e){return new(e||n)(b(E),b(Se),b(ce))};static \u0275cmp=I({type:n,selectors:[["app-videos"]],features:[z([Se])],decls:7,vars:2,consts:[["dv",""],["header",""],["grid",""],[1,"card"],[3,"value","layout"],[1,"filters-container"],["variant","on",1,"filter-item"],["pInputText","","id","VideoName","autocomplete","off",2,"width","100%",3,"ngModelChange","ngModel"],["for","VideoName",2,"font-size","large"],["Class","pi pi-search"],["variant","on",1,"w-full","md:w-56","filter-item"],["inputId","academicLevel","optionLabel","academicLevelName","optionValue","academicLevelID","styleClass","w-full",3,"ngModelChange","ngModel","options"],["for","academicLevel",2,"font-size","large"],[1,"grid","grid-cols-12","gap-4"],["class","col-span-12 sm:col-span-6 md:col-span-4 xl:col-span-6 p-2",4,"ngFor","ngForOf"],[1,"col-span-12","sm:col-span-6","md:col-span-4","xl:col-span-6","p-2"],[1,"p-6","border","border-surface-200","dark:border-surface-700","bg-surface-0","dark:bg-surface-900","rounded","flex","flex-col"],[1,"bg-surface-50","flex","justify-center","rounded","p-4"],[1,"relative","mx-auto"],[1,"rounded","w-full",2,"max-width","300px",3,"src","alt"],[1,"pt-6"],[1,"flex","flex-row","justify-between","products-start","gap-2"],[1,"font-medium","text-surface-500","dark:text-surface-400","text-sm"],[1,"text-lg","font-medium","mt-1"],[1,"flex","flex-col","gap-6","mt-6"],[1,"flex","gap-2"],["pButton","","icon","pi pi-video","label","Watch",1,"flex-auto","whitespace-nowrap",3,"click"]],template:function(e,a){e&1&&(o(0,"div",3)(1,"p-dataview",4,0),h(3,St,10,3,"ng-template",null,1,v)(5,kt,2,1,"ng-template",null,2,v),r()()),e&2&&(s(),p("value",a.videosData)("layout","grid"))},dependencies:[Ve,j,ve,M,O,P,L,A,N,H,G,ie,te,Y,K,R,U],styles:[".filters-container[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:1rem}.filter-item[_ngcontent-%COMP%]{flex:1}"]})};var Mt=()=>({width:"1000px",height:"600px"}),Ft=()=>({"min-width":"50rem"});function Dt(n,i){if(n&1){let e=S();o(0,"div",17)(1,"div",18)(2,"p-button",19),f("onClick",function(t){let l=c(e).chooseCallback,_=d();return u(_.choose(t,l))}),r(),o(3,"p-button",20),f("onClick",function(){c(e);let t=d();return u(t.uploadEvent())}),r()(),o(4,"p-progressbar",21)(5,"span",22),m(6),r()()()}if(n&2){let e=i.$implicit,a=d();s(2),p("rounded",!0)("outlined",!0)("disabled",(e==null?null:e.length)>0),s(),p("rounded",!0)("outlined",!0)("disabled",!e||e.length===0),s(),p("value",a.totalSizePercent)("showValue",!1),s(2),Q("",a.totalSize,"B / 1Mb")}}function Et(n,i){n&1&&g(0,"p-badge",31)}function Lt(n,i){n&1&&g(0,"p-badge",32)}function At(n,i){if(n&1){let e=S();o(0,"div",26)(1,"div"),g(2,"img",27),r(),o(3,"span",28),m(4),r(),o(5,"div"),m(6),r(),h(7,Et,1,0,"p-badge",29)(8,Lt,1,0,"ng-template",null,4,v),o(10,"p-button",30),f("click",function(t){let l=c(e),_=l.$implicit,T=l.index,F=d(2).removeFileCallback,de=d();return u(de.onRemoveTemplatingFile(t,_,F,T))}),r()()}if(n&2){let e=i.$implicit,a=q(9),t=d(3);s(2),p("alt",e.name)("src","assets/File/PDFile.png",W),s(2),k(e.name),s(2),k(t.formatSize(e.size)),s(),p("ngIf",t.isPending)("ngIfElse",a),s(3),p("outlined",!0)("rounded",!0)}}function Nt(n,i){if(n&1&&(o(0,"div")(1,"h5"),m(2,"Pending"),r(),o(3,"div",24),h(4,At,11,8,"div",25),r()()),n&2){let e=d().$implicit;s(4),p("ngForOf",e)}}function Pt(n,i){if(n&1&&(o(0,"div",23),h(1,Nt,5,1,"div",16),r()),n&2){let e=i.$implicit;s(),p("ngIf",(e==null?null:e.length)>0)}}function Ut(n,i){}function Rt(n,i){n&1&&(o(0,"div",33),g(1,"i",34),o(2,"p",35),m(3,"Drag and drop files to here to upload."),r()())}function Bt(n,i){n&1&&(o(0,"div",49),m(1,"\u0627\u0636\u0627\u0641\u0647 \u0641\u0635\u0644"),r())}function Wt(n,i){n&1&&g(0,"p-toast")}function zt(n,i){n&1&&(o(0,"tr")(1,"th"),m(2,"\u0627\u0633\u0645 \u0627\u0644\u0641\u0635\u0644"),r(),o(3,"th"),m(4,"\u0627\u0633\u0645 \u0627\u0644\u0645\u0631\u062D\u0644\u0647 \u0627\u0644\u062F\u0631\u0627\u0633\u064A\u0647"),r()())}function Ot(n,i){if(n&1&&(o(0,"tr",50)(1,"td"),m(2),r(),o(3,"td"),m(4),r()()),n&2){let e=i.$implicit;p("pSelectableRow",e),s(2),k(e.chapterName),s(2),k(e.academicLevelId)}}function jt(n,i){if(n&1){let e=S();o(0,"div")(1,"p-dialog",36),w("visibleChange",function(t){c(e);let l=d();return C(l.displayDialog,t)||(l.displayDialog=t),u(t)}),h(2,Bt,2,0,"ng-template",37),o(3,"div",38)(4,"p-floatlabel",39)(5,"input",40),w("ngModelChange",function(t){c(e);let l=d();return C(l.Filter.chapterName,t)||(l.Filter.chapterName=t),u(t)}),f("ngModelChange",function(){c(e);let t=d();return u(t.onFilterChange())}),r(),o(6,"label",41),m(7," \u0627\u0633\u0645 \u0627\u0644\u0641\u0635\u0644 "),r()(),o(8,"p-floatlabel",42)(9,"p-dropdown",43),w("ngModelChange",function(t){c(e);let l=d();return C(l.Filter.academicLevelId,t)||(l.Filter.academicLevelId=t),u(t)}),f("ngModelChange",function(){c(e);let t=d();return u(t.onFilterChange())}),r(),o(10,"label",44),m(11,"\u0627\u0644\u0645\u0631\u062D\u0644\u0629 \u0627\u0644\u062F\u0631\u0627\u0633\u064A\u0629"),r()()(),o(12,"div",6),h(13,Wt,1,0,"p-toast",16),o(14,"p-table",45),w("selectionChange",function(t){c(e);let l=d();return C(l.selectedChapter,t)||(l.selectedChapter=t),u(t)}),f("onRowSelect",function(t){c(e);let l=d();return u(l.onRowSelect(t))}),h(15,zt,5,0,"ng-template",null,0,v)(17,Ot,5,3,"ng-template",null,5,v),r()(),o(19,"div",46)(20,"p-button",47),f("click",function(){c(e);let t=d();return u(t.displayDialog=!1)}),r(),o(21,"p-button",48),f("click",function(){c(e);let t=d();return u(t.displayDialog=!1)}),r()()()()}if(n&2){let e=d();s(),J(V(11,Mt)),p("modal",!0),x("visible",e.displayDialog),s(4),x("ngModel",e.Filter.chapterName),s(4),x("ngModel",e.Filter.academicLevelId),p("options",e.academicLevelData),s(4),p("ngIf",e.displayDialog),s(),p("value",e.Chapters),x("selection",e.selectedChapter),p("tableStyle",V(12,Ft))}}function Gt(n,i){n&1&&g(0,"p-toast")}var Pe=class n{constructor(i,e,a,t){this.config=i;this.messageService=e;this.tasksAndVideos=a;this.chapters=t;let l=sessionStorage.getItem("teacherId");l&&(this.teacherId=+l)}files=[];chapterId;totalSize=0;totalSizePercent=0;teacherId;userId=1;taskName;academicLevelID;isBook=!1;academicLevelData=[];uploadedFiles=[];isPending=!0;Chapters=[];Filter;displayDialog=!1;selectedChapter;ngOnInit(){this.Filter={teacherId:this.teacherId.toString(),pageNumber:1,pageSize:25}}choose(i,e){this.isPending=!0,e&&e()}onRemoveTemplatingFile(i,e,a,t){a&&a(i,t),this.totalSize-=e.size,this.totalSizePercent=this.totalSize/10}onClearTemplatingUpload(i){i&&i(),this.totalSize=0,this.totalSizePercent=0}onSelectedFiles(i){this.files=i.currentFiles||[],this.totalSize=this.files.reduce((e,a)=>e+a.size,0),this.totalSizePercent=this.totalSize/10}uploadEvent(){if(!this.taskName||!this.chapterId){this.messageService.add({severity:"warn",summary:"\u062A\u0646\u0628\u064A\u0647",detail:"\u064A\u0631\u062C\u0649 \u062A\u062D\u062F\u064A\u062F \u0627\u0633\u0645 \u0627\u0644\u062A\u0627\u0633\u0643 \u0648\u0627\u0633\u0645 \u0627\u0644\u0641\u0635\u0644 \u0642\u0628\u0644 \u0627\u0644\u0631\u0641\u0639."});return}if(!this.files.length)return;let i=this.files[0],e=new FormData;e.append("file",i),e.append("userId",this.userId.toString()),e.append("teacherId",this.teacherId.toString()),e.append("isAnswer","false"),e.append("taskName",this.taskName),e.append("chapterId",this.chapterId.toString()),e.append("IsBook",this.isBook.toString()),this.tasksAndVideos.uploadFile(e).subscribe({next:a=>{a.isValidTransaction?(this.messageService.add({severity:"success",summary:"\u0646\u062C\u0627\u062D",detail:"\u062A\u0645 \u0631\u0641\u0639 \u0627\u0644\u0645\u0644\u0641 \u0628\u0646\u062C\u0627\u062D!"}),this.files=[],this.isPending=!1):this.messageService.add({severity:"error",summary:"\u062E\u0637\u0623",detail:a.transactionDetails})},error:a=>{this.messageService.add({severity:"error",summary:"\u062E\u0637\u0623",detail:"\u0641\u0634\u0644 \u0641\u064A \u0631\u0641\u0639 \u0627\u0644\u0645\u0644\u0641!"})}})}formatSize(i){if(!this.config.translation||!this.config.translation.fileSizeTypes)return`${i} B`;let e=1024,a=3,t=this.config.translation.fileSizeTypes;if(i===0)return`0 ${t[0]}`;let l=Math.floor(Math.log(i)/Math.log(e));return`${parseFloat((i/Math.pow(e,l)).toFixed(a))} ${t[l]||"B"}`}getAcademicLevelFilter(){this.tasksAndVideos.getAllAcademicLevels().subscribe({next:i=>{this.academicLevelData=i}})}getChapterData(){this.chapters.getAllChapters(this.Filter).subscribe({next:i=>{this.Chapters=i.items},error:i=>{console.error("Error fetching teachers:",i)}})}onFilterChange(){this.getChapterData()}showDialog(){this.getChapterData(),this.getAcademicLevelFilter(),this.displayDialog=!0}onRowSelect(i){this.chapterId=i.data.chapterID,this.messageService.add({severity:"info",summary:"\u062A\u0645 \u0627\u062E\u062A\u064A\u0627\u0631 \u0627\u0644\u0641\u0635\u0644",detail:i.data.name})}static \u0275fac=function(e){return new(e||n)(b(Ke),b(D),b(E),b(Me))};static \u0275cmp=I({type:n,selectors:[["app-upload-tasks"]],features:[z([D])],decls:22,vars:6,consts:[["header",""],["content",""],["file",""],["empty",""],["templateName",""],["body",""],[1,"card"],[1,"filters-container"],["variant","on",1,"filter-item"],["pInputText","","id","on_label","autocomplete","off",2,"width","100%",3,"ngModelChange","ngModel"],["for","on_label",2,"font-size","large"],["label","\u0627\u062E\u062A\u0631 \u0627\u0644\u0641\u0635\u0644","icon","pi pi-plus",1,"add-chapter-btn",3,"click"],[1,"CheckBox"],[3,"ngModelChange","ngModel","binary"],["for","ny",1,"ml-3"],["accept","application/pdf","maxFileSize","1000000",3,"onSelect","multiple"],[4,"ngIf"],[1,"flex","flex-wrap","justify-between","items-center","flex-1","gap-4"],[1,"flex","gap-2"],["icon","pi pi-images",3,"onClick","rounded","outlined","disabled"],["icon","pi pi-cloud-upload","severity","success",3,"onClick","rounded","outlined","disabled"],["styleClass","md:w-20rem h-1 w-full md:ml-auto",1,"w-full",3,"value","showValue"],[1,"whitespace-nowrap"],[1,"flex","flex-col","gap-8","pt-4"],[1,"flex","flex-wrap","gap-4"],["class","p-8 rounded-border flex flex-col border border-surface items-center gap-4",4,"ngFor","ngForOf"],[1,"p-8","rounded-border","flex","flex-col","border","border-surface","items-center","gap-4"],["role","presentation","width","100","height","50",3,"alt","src"],[1,"font-semibold","text-ellipsis","max-w-60","whitespace-nowrap","overflow-hidden"],["value","Pending","severity","warn",4,"ngIf","ngIfElse"],["icon","pi pi-times","severity","danger",3,"click","outlined","rounded"],["value","Pending","severity","warn"],["value","Completed","severity","success",1,"mt-4"],[1,"flex","items-center","justify-center","flex-col"],[1,"pi","pi-cloud-upload","!border-2","!rounded-full","!p-8","!text-4xl","!text-muted-color"],[1,"mt-6","mb-0"],["header","\u0627\u0636\u0627\u0641\u0647 \u0641\u0635\u0644",3,"visibleChange","modal","visible"],["pTemplate","header"],[1,"flex","items-center","gap-4","mb-4","mt-4"],["variant","on",1,"filter-item",2,"margin-top","10px"],["pInputText","","id","taskName","autocomplete","off",2,"width","100%",3,"ngModelChange","ngModel"],["for","taskName",2,"font-size","large"],["variant","on",1,"w-full","md:w-56","filter-item",2,"margin-top","10px"],["inputId","academicLevel","optionLabel","academicLevelName","optionValue","academicLevelID","styleClass","w-full",3,"ngModelChange","ngModel","options"],["for","academicLevel",2,"font-size","large"],["selectionMode","single","dataKey","chapterID",3,"selectionChange","onRowSelect","value","selection","tableStyle"],[1,"flex","justify-end","gap-2",2,"margin-top","50px"],["label","Cancel","severity","secondary",3,"click"],["label","Save","severity","success",3,"click"],[1,"custom-header"],[3,"pSelectableRow"]],template:function(e,a){if(e&1){let t=S();o(0,"div",6)(1,"div",7)(2,"p-floatlabel",8)(3,"input",9),w("ngModelChange",function(_){return c(t),C(a.taskName,_)||(a.taskName=_),u(_)}),r(),o(4,"label",10),m(5,"\u0627\u0633\u0645 \u0627\u0644\u062A\u0627\u0633\u0643"),r()(),o(6,"p-button",11),f("click",function(){return c(t),u(a.showDialog())}),r()(),o(7,"div",12)(8,"p-checkbox",13),w("ngModelChange",function(_){return c(t),C(a.isBook,_)||(a.isBook=_),u(_)}),r(),o(9,"label",14),m(10,"Is Book "),r()(),o(11,"p-fileupload",15),f("onSelect",function(_){return c(t),u(a.onSelectedFiles(_))}),h(12,Dt,7,9,"ng-template",null,0,v)(14,Pt,2,1,"ng-template",null,1,v)(16,Ut,0,0,"ng-template",null,2,v)(18,Rt,4,0,"ng-template",null,3,v),r()(),h(20,jt,22,13,"div",16)(21,Gt,1,0,"p-toast",16)}e&2&&(s(3),x("ngModel",a.taskName),s(5),x("ngModel",a.isBook),p("binary",!0),s(3),p("multiple",!1),s(9),p("ngIf",a.displayDialog),s(),p("ngIf",!a.displayDialog))},dependencies:[ae,j,xe,fe,ee,he,ye,oe,ne,be,$,Z,me,M,O,X,R,U,Ie,Te,P,L,A,N,ke,H,G,Y,K,we,Ce],styles:[".filters-container[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:1rem}.filter-item[_ngcontent-%COMP%]{flex:1}.CheckBox[_ngcontent-%COMP%]{padding-bottom:20px;font-size:large;display:flex}"]})};var Ht=()=>[10,25,50],Kt=()=>({"min-width":"75rem"});function Yt(n,i){if(n&1){let e=S();o(0,"tr")(1,"th",6),m(2,"#"),r(),o(3,"th",7),m(4,"Answer Name "),r(),o(5,"th",8),m(6,"Student Name"),r(),o(7,"th",8),m(8,"Academic Level Name"),r(),o(9,"th",9),m(10,"Download Answer"),r()(),o(11,"tr"),g(12,"th"),o(13,"th")(14,"p-iconfield",10)(15,"p-inputicon"),g(16,"i",11),r(),o(17,"input",12),w("ngModelChange",function(t){c(e);let l=d();return C(l.Filter.AnswerName,t)||(l.Filter.AnswerName=t),u(t)}),f("ngModelChange",function(){c(e);let t=d();return u(t.onFilterChange())}),r()()(),o(18,"th")(19,"p-iconfield",10)(20,"p-inputicon"),g(21,"i",11),r(),o(22,"input",13),w("ngModelChange",function(t){c(e);let l=d();return C(l.Filter.StudentName,t)||(l.Filter.StudentName=t),u(t)}),f("ngModelChange",function(){c(e);let t=d();return u(t.onFilterChange())}),r()()(),o(23,"th")(24,"p-iconfield",10)(25,"p-inputicon"),g(26,"i",11),r(),o(27,"input",13),w("ngModelChange",function(t){c(e);let l=d();return C(l.Filter.AcademicLevelName,t)||(l.Filter.AcademicLevelName=t),u(t)}),f("ngModelChange",function(){c(e);let t=d();return u(t.onFilterChange())}),r()()(),g(28,"th"),r()}if(n&2){let e=d();s(17),x("ngModel",e.Filter.AnswerName),s(5),x("ngModel",e.Filter.StudentName),s(5),x("ngModel",e.Filter.AcademicLevelName)}}function qt(n,i){if(n&1){let e=S();o(0,"tr")(1,"td",14),m(2),r(),o(3,"td",14),m(4),r(),o(5,"td",14),m(6),r(),o(7,"td",14),m(8),r(),o(9,"td",14)(10,"button",15),f("click",function(){let t=c(e).$implicit,l=d();return u(l.downloadTask(t.fileName))}),g(11,"i",16),m(12," Download "),r()()()}if(n&2){let e=i.$implicit,a=i.rowIndex;s(2),k(a+1),s(2),k(e.answerName),s(2),k(e.studentId),s(2),k(e.academicLevelName)}}function Jt(n,i){n&1&&(o(0,"tr")(1,"td",17),m(2,"No Data found."),r()())}var Ue=class n{constructor(i){this.tasksAndVideos=i;let e=sessionStorage.getItem("teacherId");e&&(this.teacherId=+e);let a=sessionStorage.getItem("fileId");a&&(this.fileId=+a)}studentAnswer=[];academicLevelId=4;studentAnswerData;teacherId;loading=!0;fileId;Filter;ngOnInit(){this.Filter={teacherId:this.teacherId,filesId:this.fileId,pageNumber:1,pageSize:25},this.getStudentAnswer()}getStudentAnswer(){this.tasksAndVideos.getStudentAnswer(this.Filter).subscribe({next:i=>{this.studentAnswerData=i.items,console.log("\u{1F680} ~ TasksComponent ~ this.tasksAndVideos.getStudentAnswer ~ this.tasksAndVideos:",this.studentAnswerData),this.loading=!1},error:i=>{console.error("Error fetching StudentAnswer:",i),this.loading=!1}})}onFilterChange(){this.getStudentAnswer()}downloadTask(i){this.tasksAndVideos.downloadFile(i).subscribe({next:e=>{let a=new Blob([e.body],{type:e.body?.type}),t=e.headers.get("Content-Disposition"),l=i;if(t){let F=t.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/);F&&F[1]&&(l=F[1].replace(/['"]/g,""))}let _=window.URL.createObjectURL(a),T=document.createElement("a");T.href=_,T.download=l,T.click(),window.URL.revokeObjectURL(_)},error:e=>{console.error("Error downloading file:",e)}})}static \u0275fac=function(e){return new(e||n)(b(E))};static \u0275cmp=I({type:n,selectors:[["app-student-tasks-dashboard"]],decls:9,vars:8,consts:[["dt2",""],["header",""],["body",""],["emptymessage",""],[1,"card"],["dataKey","id",3,"value","rows","rowsPerPageOptions","loading","paginator","tableStyle"],[2,"width","5%"],[2,"width","30%"],[2,"width","22%"],[2,"width","15%"],["iconPosition","left",1,"ml-auto"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Seaprch keyword",3,"ngModelChange","ngModel"],["pInputText","","type","text","placeholder","Search keyword",3,"ngModelChange","ngModel"],[1,"text-center"],[1,"bg-green-500","hover:bg-green-600","text-white","py-2","px-4","rounded","flex","items-center","gap-2",3,"click"],[1,"pi","pi-clipboard"],["colspan","5"]],template:function(e,a){e&1&&(o(0,"div",4)(1,"p-table",5,0),h(3,Yt,29,3,"ng-template",null,1,v)(5,qt,13,4,"ng-template",null,2,v)(7,Jt,3,0,"ng-template",null,3,v),r()()),e&2&&(s(),p("value",a.studentAnswerData)("rows",a.Filter.pageSize)("rowsPerPageOptions",V(6,Ht))("loading",a.loading)("paginator",!0)("tableStyle",V(7,Kt)))},dependencies:[re,oe,ne,Xe,qe,Ye,R,U,ie,te,ke,Je,me,M,P,L,A,N],encapsulation:2})};var Qt=()=>({width:"1000px",height:"600px"}),Xt=()=>({"min-width":"50rem"});function Zt(n,i){if(n&1){let e=S();o(0,"div",14)(1,"div",15)(2,"p-button",16),f("onClick",function(t){let l=c(e).chooseCallback,_=d();return u(_.choose(t,l))}),r(),o(3,"p-button",17),f("onClick",function(){c(e);let t=d();return u(t.uploadVideo())}),r(),o(4,"p-button",18),f("onClick",function(){let t=c(e).clearCallback,l=d();return u(l.resetVideoSelection(t))}),r()(),g(5,"p-progressbar",19),r()}if(n&2){let e=i.$implicit,a=d();s(2),p("rounded",!0)("outlined",!0)("disabled",(e==null?null:e.length)>0),s(),p("rounded",!0)("outlined",!0)("disabled",!a.selectedVideo),s(),p("rounded",!0)("outlined",!0)("disabled",!e||e.length===0),s(),p("value",a.uploadProgress)("showValue",!1)}}function $t(n,i){n&1&&(o(0,"h5"),m(1,"Pending"),r())}function ei(n,i){n&1&&(o(0,"h5"),m(1," Completed "),r())}function ti(n,i){if(n&1&&h(0,ei,2,0,"h5",21),n&2){d();let e=q(5),a=d(2);p("ngIf",a.isPending===2)("ngIfElse",e)}}function ii(n,i){n&1&&(o(0,"h5"),m(1," Error "),r())}function ni(n,i){if(n&1&&h(0,ii,2,0,"h5",13),n&2){let e=d(3);p("ngIf",e.isPending===3)}}function oi(n,i){n&1&&g(0,"p-badge",29)}function ai(n,i){n&1&&g(0,"p-badge",31)}function ri(n,i){if(n&1&&h(0,ai,1,0,"p-badge",30),n&2){d();let e=q(10),a=d(3);p("ngIf",a.isPending===2)("ngIfElse",e)}}function li(n,i){n&1&&g(0,"p-badge",33)}function si(n,i){if(n&1&&h(0,li,1,0,"p-badge",32),n&2){let e=d(4);p("ngIf",e.isPending===3)}}function di(n,i){if(n&1){let e=S();o(0,"div",24),g(1,"i",25),o(2,"span",26),m(3),r(),o(4,"div"),m(5),r(),h(6,oi,1,0,"p-badge",27)(7,ri,1,2,"ng-template",null,3,v)(9,si,1,1,"ng-template",null,4,v),o(11,"p-button",28),f("click",function(){let t=c(e).index,l=d(2).removeFileCallback,_=d();return u(_.onRemoveVideo(l,t))}),r()()}if(n&2){let e=i.$implicit,a=q(8),t=d(3);s(3),Q(" ",e.name," "),s(2),k(t.formatSize(e.size)),s(),p("ngIf",t.isPending===1)("ngIfElse",a),s(5),p("outlined",!0)("rounded",!0)}}function pi(n,i){if(n&1&&(o(0,"div"),h(1,$t,2,0,"h5",21)(2,ti,1,2,"ng-template",null,3,v)(4,ni,1,1,"ng-template",null,4,v),o(6,"div",22),h(7,di,12,6,"div",23),r()()),n&2){let e=q(3),a=d().$implicit,t=d();s(),p("ngIf",t.isPending===1)("ngIfElse",e),s(6),p("ngForOf",a)}}function mi(n,i){if(n&1&&(o(0,"div",20),h(1,pi,8,3,"div",13),r()),n&2){let e=i.$implicit;s(),p("ngIf",(e==null?null:e.length)>0)}}function ci(n,i){n&1&&(o(0,"div",34),g(1,"i",35),o(2,"p",36),m(3,"\u0627\u0633\u062D\u0628 \u0627\u0644\u0641\u064A\u062F\u064A\u0648 \u0647\u0646\u0627 \u0623\u0648 \u0627\u062E\u062A\u0631\u0647 \u0645\u0646 \u062C\u0647\u0627\u0632\u0643."),r()())}function ui(n,i){n&1&&(o(0,"div",50),m(1,"\u0627\u0636\u0627\u0641\u0647 \u0641\u0635\u0644"),r())}function _i(n,i){n&1&&g(0,"p-toast")}function gi(n,i){n&1&&(o(0,"tr")(1,"th"),m(2,"\u0627\u0633\u0645 \u0627\u0644\u0641\u0635\u0644"),r(),o(3,"th"),m(4,"\u0627\u0633\u0645 \u0627\u0644\u0645\u0631\u062D\u0644\u0647 \u0627\u0644\u062F\u0631\u0627\u0633\u064A\u0647"),r()())}function fi(n,i){if(n&1&&(o(0,"tr",51)(1,"td"),m(2),r(),o(3,"td"),m(4),r()()),n&2){let e=i.$implicit;p("pSelectableRow",e),s(2),k(e.chapterName),s(2),k(e.academicLevelId)}}function hi(n,i){if(n&1){let e=S();o(0,"div")(1,"p-dialog",37),w("visibleChange",function(t){c(e);let l=d();return C(l.displayDialog,t)||(l.displayDialog=t),u(t)}),h(2,ui,2,0,"ng-template",38),o(3,"div",39)(4,"p-floatlabel",40)(5,"input",41),w("ngModelChange",function(t){c(e);let l=d();return C(l.Filter.chapterName,t)||(l.Filter.chapterName=t),u(t)}),f("ngModelChange",function(){c(e);let t=d();return u(t.onFilterChange())}),r(),o(6,"label",42),m(7," \u0627\u0633\u0645 \u0627\u0644\u0641\u0635\u0644 "),r()(),o(8,"p-floatlabel",43)(9,"p-dropdown",44),w("ngModelChange",function(t){c(e);let l=d();return C(l.Filter.academicLevelId,t)||(l.Filter.academicLevelId=t),u(t)}),f("ngModelChange",function(){c(e);let t=d();return u(t.onFilterChange())}),r(),o(10,"label",45),m(11,"\u0627\u0644\u0645\u0631\u062D\u0644\u0629 \u0627\u0644\u062F\u0631\u0627\u0633\u064A\u0629"),r()()(),o(12,"div",6),h(13,_i,1,0,"p-toast",13),o(14,"p-table",46),w("selectionChange",function(t){c(e);let l=d();return C(l.selectedChapter,t)||(l.selectedChapter=t),u(t)}),f("onRowSelect",function(t){c(e);let l=d();return u(l.onRowSelect(t))}),h(15,gi,5,0,"ng-template",null,0,v)(17,fi,5,3,"ng-template",null,5,v),r()(),o(19,"div",47)(20,"p-button",48),f("click",function(){c(e);let t=d();return u(t.displayDialog=!1)}),r(),o(21,"p-button",49),f("click",function(){c(e);let t=d();return u(t.displayDialog=!1)}),r()()()()}if(n&2){let e=d();s(),J(V(11,Qt)),p("modal",!0),x("visible",e.displayDialog),s(4),x("ngModel",e.Filter.chapterName),s(4),x("ngModel",e.Filter.academicLevelId),p("options",e.academicLevelData),s(4),p("ngIf",e.displayDialog),s(),p("value",e.Chapters),x("selection",e.selectedChapter),p("tableStyle",V(12,Xt))}}function vi(n,i){n&1&&g(0,"p-toast")}var Re=class n{constructor(i,e,a,t){this.chapters=i;this.tasksAndVideosService=e;this.messageService=a;this.confirmationService=t;let l=sessionStorage.getItem("teacherId");l&&(this.teacherId=l)}selectedVideo=null;chunkSize=5*1024*1024;uploadProgress=0;userId=1;teacherId;isPending;academicLevelData=[];VideoName;displayDialog=!1;Chapters=[];Filter;selectedChapter;chapterId;academicLevelID;ngOnInit(){this.Filter={teacherId:this.teacherId.toString(),pageNumber:1,pageSize:25},this.getAcademicLevelFilter()}getAcademicLevelFilter(){this.tasksAndVideosService.getAllAcademicLevels().subscribe({next:i=>{this.academicLevelData=i}})}onVideoSelected(i){this.selectedVideo=i.files[0]}uploadVideo(){return je(this,null,function*(){if(!this.VideoName||!this.chapterId){this.messageService.add({severity:"warn",summary:"\u062A\u0646\u0628\u064A\u0647",detail:"\u064A\u0631\u062C\u0649 \u062A\u062D\u062F\u064A\u062F \u0627\u0633\u0645 \u0627\u0644\u0641\u062F\u064A\u0648 \u0648\u0627\u0633\u0645 \u0627\u0644\u0641\u0635\u0644 \u0642\u0628\u0644 \u0627\u0644\u0631\u0641\u0639."});return}if(!this.selectedVideo)return;let i=this.selectedVideo.name,e=Math.ceil(this.selectedVideo.size/this.chunkSize);try{let t=(yield this.checkUploadedChunks(i,this.userId)).length,l=(_=0)=>{if(t>=e){this.messageService.add({severity:"success",summary:"\u0646\u062C\u0627\u062D",detail:"\u062A\u0645 \u0631\u0641\u0639 \u0627\u0644\u0641\u064A\u062F\u064A\u0648 \u0628\u0646\u062C\u0627\u062D"}),this.selectedVideo=null,this.isPending=2,this.uploadProgress=100;return}this.isPending=1;let T=t*this.chunkSize,F=Math.min(T+this.chunkSize,this.selectedVideo.size),de=this.selectedVideo.slice(T,F),y=new FormData;y.append("FileName",i),y.append("Chunk",de),y.append("ChunkNumber",(t+1).toString()),y.append("TotalChunks",e.toString()),y.append("UserId",this.userId.toString()),y.append("TeacherId",this.teacherId),y.append("chapterId",this.chapterId.toString()),this.tasksAndVideosService.uploadFileChunk(y).subscribe({next:B=>{debugger;if(console.log("Server response:",B),t++,this.uploadProgress=Math.round(t/e*100),B?.isValidTransaction)l();else{this.messageService.add({severity:"error",summary:"\u062E\u0637\u0623",detail:B.transactionDetails}),this.uploadProgress=0,this.isPending=3;return}},error:B=>{debugger;console.error("Upload error:",B),(B.status===0||B.status===408||B.status>=500||_<3)&&_<3?(console.log(`Retrying chunk ${t+1}, attempt ${_+1}`),setTimeout(()=>{l(_+1)},Math.pow(2,_)*1e3)):(this.confirmationService.confirm({header:"\u062E\u0637\u0623",message:"\u0641\u0634\u0644 \u0631\u0641\u0639 \u0627\u0644\u0641\u064A\u062F\u064A\u0648. \u0642\u0645 \u0628\u0627\u0644\u0636\u063A\u0637 \u0639\u0644\u064A \u0632\u0631\u0627\u0631 \u0627\u0644\u0631\u0641\u0639 \u0645\u0631\u0647 \u0627\u062E\u0631\u064A.",icon:"pi pi-exclamation-triangle text-red-500 text-5xl",acceptVisible:!1,rejectVisible:!1,closeOnEscape:!0,closable:!0}),this.uploadProgress=0,this.isPending=3)}})};l()}catch{this.messageService.add({severity:"error",summary:"\u062E\u0637\u0623",detail:"\u0641\u0634\u0644 \u0627\u0644\u062A\u062D\u0642\u0642 \u0645\u0646 \u0627\u0644\u0623\u062C\u0632\u0627\u0621 \u0627\u0644\u0645\u0631\u0641\u0648\u0639\u0629"})}})}checkUploadedChunks(i,e){return new Promise((a,t)=>{this.tasksAndVideosService.checkUploadedChunks(e,i).subscribe({next:l=>{a(l.uploadedChunkNumbers||[])},error:l=>{t(l)}})})}choose(i,e){this.isPending=1,i.preventDefault(),e()}formatSize(i){if(i===0)return"0 Bytes";let e=1024,a=["Bytes","KB","MB","GB","TB"],t=Math.floor(Math.log(i)/Math.log(e));return`${parseFloat((i/Math.pow(e,t)).toFixed(2))} ${a[t]}`}onRemoveVideo(i,e){i(e),this.uploadProgress=0,this.selectedVideo=null}resetVideoSelection(i){i(),this.selectedVideo=null,this.uploadProgress=0,this.isPending=1}onFilterChange(){this.getChapterData()}showDialog(){this.getChapterData(),this.getAcademicLevelFilter(),this.displayDialog=!0}getChapterData(){this.chapters.getAllChapters(this.Filter).subscribe({next:i=>{this.Chapters=i.items},error:i=>{console.error("Error fetching teachers:",i)}})}onRowSelect(i){this.chapterId=i.data.chapterID,this.messageService.add({severity:"info",summary:"\u062A\u0645 \u0627\u062E\u062A\u064A\u0627\u0631 \u0627\u0644\u0641\u0635\u0644",detail:i.data.name})}static \u0275fac=function(e){return new(e||n)(b(Me),b(E),b(D),b(ge))};static \u0275cmp=I({type:n,selectors:[["app-upload-videos"]],features:[z([D,ge])],decls:17,vars:4,consts:[["header",""],["content",""],["empty",""],["templateCompleted",""],["templateError",""],["body",""],[1,"card"],[1,"filters-container"],["variant","on",1,"filter-item"],["pInputText","","id","VideoName","autocomplete","off",2,"width","100%",3,"ngModelChange","ngModel"],["for","VideoName",2,"font-size","large"],["label","\u0627\u062E\u062A\u0631 \u0627\u0644\u0641\u0635\u0644","icon","pi pi-plus",1,"add-chapter-btn",3,"click"],["accept","video/mp4","customUpload","true",3,"onSelect","multiple"],[4,"ngIf"],[1,"flex","flex-wrap","justify-between","items-center","flex-1","gap-4"],[1,"flex","gap-2"],["icon","pi pi-video",3,"onClick","rounded","outlined","disabled"],["icon","pi pi-cloud-upload","severity","success",3,"onClick","rounded","outlined","disabled"],["icon","pi pi-times","severity","danger",3,"onClick","rounded","outlined","disabled"],["styleClass","md:w-20rem h-1 w-full md:ml-auto",1,"w-full",3,"value","showValue"],[1,"flex","flex-col","gap-8","pt-4"],[4,"ngIf","ngIfElse"],[1,"flex","flex-wrap","gap-4"],["class","p-8 rounded-border flex flex-col border border-surface items-center gap-4",4,"ngFor","ngForOf"],[1,"p-8","rounded-border","flex","flex-col","border","border-surface","items-center","gap-4"],[1,"pi","pi-video","text-6xl"],[1,"font-semibold","text-ellipsis","max-w-60","whitespace-nowrap","overflow-hidden"],["value","Pending","severity","warn",4,"ngIf","ngIfElse"],["icon","pi pi-times","severity","danger",3,"click","outlined","rounded"],["value","Pending","severity","warn"],["value","Completed","class","mt-4","severity","success",4,"ngIf","ngIfElse"],["value","Completed","severity","success",1,"mt-4"],["value","Error","class","mt-4","severity","danger",4,"ngIf"],["value","Error","severity","danger",1,"mt-4"],[1,"flex","items-center","justify-center","flex-col"],[1,"pi","pi-video","!border-2","!rounded-full","!p-8","!text-4xl","!text-muted-color"],[1,"mt-6","mb-0"],["header","\u0627\u0636\u0627\u0641\u0647 \u0641\u0635\u0644",3,"visibleChange","modal","visible"],["pTemplate","header"],[1,"flex","items-center","gap-4","mb-4","mt-4"],["variant","on",1,"filter-item",2,"margin-top","10px"],["pInputText","","id","taskName","autocomplete","off",2,"width","100%",3,"ngModelChange","ngModel"],["for","taskName",2,"font-size","large"],["variant","on",1,"w-full","md:w-56","filter-item",2,"margin-top","10px"],["inputId","academicLevel","optionLabel","academicLevelName","optionValue","academicLevelID","styleClass","w-full",3,"ngModelChange","ngModel","options"],["for","academicLevel",2,"font-size","large"],["selectionMode","single","dataKey","chapterID",3,"selectionChange","onRowSelect","value","selection","tableStyle"],[1,"flex","justify-end","gap-2",2,"margin-top","50px"],["label","Cancel","severity","secondary",3,"click"],["label","Save","severity","success",3,"click"],[1,"custom-header"],[3,"pSelectableRow"]],template:function(e,a){if(e&1){let t=S();o(0,"div",6)(1,"div",7)(2,"p-floatlabel",8)(3,"input",9),w("ngModelChange",function(_){return c(t),C(a.VideoName,_)||(a.VideoName=_),u(_)}),r(),o(4,"label",10),m(5,"\u0627\u0633\u0645 \u0627\u0644\u0641\u062F\u064A\u0648"),r()(),o(6,"p-button",11),f("click",function(){return c(t),u(a.showDialog())}),r()(),o(7,"p-fileupload",12),f("onSelect",function(_){return c(t),u(a.onVideoSelected(_))}),h(8,Zt,6,11,"ng-template",null,0,v)(10,mi,2,1,"ng-template",null,1,v)(12,ci,4,0,"ng-template",null,2,v),r()(),h(14,hi,22,13,"div",13),g(15,"p-confirmdialog"),h(16,vi,1,0,"p-toast",13)}e&2&&(s(3),x("ngModel",a.VideoName),s(4),p("multiple",!1),s(7),p("ngIf",a.displayDialog),s(2),p("ngIf",!a.displayDialog))},dependencies:[M,O,X,re,ae,fe,H,G,Y,K,oe,ne,be,P,L,A,N,j,xe,ye,ee,he,$,Z,Ie,Te,R,U,rt,at],styles:[".filters-container[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:3rem}.filter-item[_ngcontent-%COMP%]{flex:1}"]})};function xi(n,i){if(n&1&&(o(0,"video",6),g(1,"source",7),m(2," \u0645\u062A\u0635\u0641\u062D\u0643 \u0644\u0627 \u064A\u062F\u0639\u0645 \u062A\u0634\u063A\u064A\u0644 \u0627\u0644\u0641\u064A\u062F\u064A\u0648. "),r()),n&2){let e=d();s(),p("src",e.videoUrl,W)}}var Be=class n{constructor(i){this.tasksAndVideosService=i;let e=sessionStorage.getItem("videoName");e&&(this.videoName=e)}videoUrl;videoName;ngOnInit(){this.getVideoFile()}getVideoFile(){this.tasksAndVideosService.getVideoFile(this.videoName).subscribe({next:i=>{debugger;this.videoUrl=i.url,console.log("\u{1F680} ~ VideoPlayerComponent ~ this.tasksAndVideosService.getVideoById ~ this.videoUrl:",this.videoUrl)}})}static \u0275fac=function(e){return new(e||n)(b(E))};static \u0275cmp=I({type:n,selectors:[["app-video-player"]],decls:7,vars:2,consts:[[1,"justify-center","p-4"],[1,"w-full","h-full","w-full","md:w-8/12","shadow-2xl","rounded-2xl","overflow-hidden"],[1,"mt-4","flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-primary-600","flex-1","text-right"],[1,"video-container"],["width","100%","height","100%","controls","",4,"ngIf"],["width","100%","height","100%","controls",""],["type","video/mp4",3,"src"]],template:function(e,a){e&1&&(o(0,"div",0)(1,"p-card",1)(2,"div",2)(3,"h2",3),m(4),r()(),o(5,"div",4),h(6,xi,3,1,"video",5),r()()()),e&2&&(s(4),Q(" ",a.videoName.replace(".mp4","")," "),s(2),p("ngIf",a.videoUrl))},dependencies:[M,X,ot,nt,ee,Qe,Ze],styles:[".video-container[_ngcontent-%COMP%]{position:relative;width:100%;max-width:800px;margin:auto;padding:20px;background:#000;border-radius:10px;box-shadow:0 0 15px #0000004d}video[_ngcontent-%COMP%]{max-height:400px;object-fit:contain}"]})};var po=[{path:"",component:Ae,children:[{path:"",redirectTo:"tasks",pathMatch:"full"},{path:"tasks",component:Fe},{path:"videos",component:Ne},{path:"uploadTasks",component:Pe},{path:"uploadVideos",component:Re}]},{path:"studentTasksDashboard",component:Ue},{path:"VideoPlayer",component:Be}];export{po as default};
