import{c as De,e as me,f as ce,j as Ee,k as Le,m as ct,n as ut,o as _t,r as gt,s as ft}from"./chunk-HI2TDCOG.js";import{b as dt}from"./chunk-YPK5KGQ4.js";import{a as Ae,b as Pe,c as j,d as G,e as D,f as ge}from"./chunk-CVZTTP23.js";import{c as z,d as O,e as mt,f as Ne,h as ht,i as vt,j as ue,k as _e}from"./chunk-ONA3RLDT.js";import{$ as Fe,A as ee,B as te,G as Me,L as ie,Q as Te,S as at,T as rt,U as lt,V as st,W as pt,_ as ne,y as nt,z as ot}from"./chunk-WWXKWVPM.js";import"./chunk-LCP6WAMI.js";import{Ab as $,Fb as ke,Ga as X,Gb as se,Hb as pe,Ib as de,Jb as W,Ka as F,Kb as Ie,Lb as Ve,Mb as U,Nb as R,Oa as le,Xa as it,_a as L,ab as N,db as A,hb as P,i as we,n as et,o as tt,p as be,q as ye,v as Se,zb as Z}from"./chunk-EIK6HXDD.js";import{Bb as K,Hb as a,Ib as l,Jb as f,Nb as y,Pb as _,Qb as s,Ta as Y,Uc as J,Vc as Q,Ya as p,Za as w,a as Ze,ac as oe,bc as m,bd as T,cc as I,dc as q,e as $e,fc as v,gc as C,hc as x,ic as B,jb as M,jc as S,la as c,ma as u,qb as h,xc as b,yb as d}from"./chunk-OT2PUON7.js";var St=()=>["/pages/teachers/videos-and-tasks/studentTasksDashboard"],kt=()=>({width:"100%",height:"100%"});function It(n,i){if(n&1){let e=y();a(0,"div",4)(1,"p-floatlabel",5)(2,"input",6),x("ngModelChange",function(t){c(e);let r=s();return C(r.Filter.taskName,t)||(r.Filter.taskName=t),u(t)}),_("ngModelChange",function(){c(e);let t=s();return u(t.onFilterChange())}),l(),a(3,"label",7),f(4,"p-inputicon",8),m(5," \u0627\u0633\u0645 \u0627\u0644\u062A\u0627\u0633\u0643"),l()(),a(6,"p-floatlabel",9)(7,"p-dropdown",10),x("ngModelChange",function(t){c(e);let r=s();return C(r.Filter.academicLevelId,t)||(r.Filter.academicLevelId=t),u(t)}),_("ngModelChange",function(){c(e);let t=s();return u(t.onFilterChange())}),l(),a(8,"label",11),m(9,"\u0627\u0644\u0645\u0631\u062D\u0644\u0629 \u0627\u0644\u062F\u0631\u0627\u0633\u064A\u0629"),l()()(),a(10,"div",12)(11,"p-checkbox",13),x("ngModelChange",function(t){c(e);let r=s();return C(r.Filter.isBook,t)||(r.Filter.isBook=t),u(t)}),_("ngModelChange",function(){c(e);let t=s();return u(t.onFilterChange())}),l(),a(12,"label",14),m(13,"Is Book "),l()()}if(n&2){let e=s();p(2),v("ngModel",e.Filter.taskName),p(5),v("ngModel",e.Filter.academicLevelId),d("options",e.academicLevelData),p(4),v("ngModel",e.Filter.isBook),d("binary",!0)}}function Vt(n,i){if(n&1){let e=y();a(0,"div",17)(1,"div",18)(2,"div",19)(3,"div",20),f(4,"img",21),l()(),a(5,"div",22)(6,"div",23)(7,"div")(8,"span",24),m(9,"PDF"),l(),a(10,"div",25),m(11),l()()(),a(12,"div",26),f(13,"button",27),l(),a(14,"div",28)(15,"button",29),_("click",function(){let t=c(e).$implicit,r=s(2);return u(r.downloadTask(t.fileName))}),l(),a(16,"div",30)(17,"p-fileUpload",31),_("uploadHandler",function(t){let r=c(e).$implicit,g=s(2);return u(g.uploadTask(t,r.filesID,g.studentId,r.teacherID,!0,r.academicLevelID,r.taskName,r.taskName+"Answer"))}),l()()()()()()}if(n&2){let e=i.$implicit;p(4),d("src","assets/File/PDFile.png",Y)("alt","PDF"),p(7),I(e.taskName),p(2),d("outlined",!e.isAnswer)("routerLink",S(10,St)),p(4),K(S(11,kt)),d("auto",!0)("disabled",!1)("accept","application/pdf")}}function Mt(n,i){if(n&1&&(a(0,"div",15),h(1,Vt,18,12,"div",16),l()),n&2){let e=s();p(),d("ngForOf",e.tasksFiles)}}var Ue=class n{constructor(i,e,o,t){this.tasksAndVideos=i;this.route=e;this.messageService=o;this.router=t;let r=sessionStorage.getItem("teacherId");r&&(this.teacherId=+r);let g=sessionStorage.getItem("chapterId");g&&(this.chapterId=+g)}teacherId;chapterId;tasksFiles=[];studentId=3;academicLevelId=4;Filter;academicLevelData=[];layout="list";options=["list","grid"];ngOnInit(){this.Filter={teacherId:this.teacherId,chapterId:this.chapterId,academicLevelId:this.academicLevelId,pageNumber:1,pageSize:25},this.getPDFiles(),this.getAcademicLevelFilter()}getPDFiles(){this.tasksAndVideos.getTeachersFiles(this.Filter).subscribe({next:i=>{this.tasksFiles=i.items},error:i=>{console.error("Error fetching teachers:",i)}})}getAcademicLevelFilter(){this.tasksAndVideos.getAllAcademicLevels().subscribe({next:i=>{this.academicLevelData=i}})}downloadTask(i){this.tasksAndVideos.downloadFile(i).subscribe({next:e=>{let o=new Blob([e.body],{type:e.body?.type}),t=e.headers.get("Content-Disposition"),r=i;if(t){let E=t.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/);E&&E[1]&&(r=E[1].replace(/['"]/g,""))}let g=window.URL.createObjectURL(o),V=document.createElement("a");V.href=g,V.download=r,V.click(),window.URL.revokeObjectURL(g)},error:e=>{console.error("Error downloading file:",e)}})}uploadTask(i,e,o,t,r,g,V,E){let he=i.files[0],k=new FormData;k.append("file",he),k.append("fileID",e.toString()),k.append("studentId",o?o.toString():""),k.append("teacherId",t.toString()),k.append("isAnswer",r.toString()),k.append("academicLevelID",g.toString()),k.append("taskName",V),k.append("answerName",E),this.tasksAndVideos.uploadFile(k).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Success",detail:"File uploaded successfully!"}),this.getPDFiles()},error:H=>{this.messageService.add({severity:"error",summary:"Error",detail:"Upload failed!"})}})}navigateWithFileId(i){sessionStorage.setItem("fileId",i.toString()),this.router.navigate(["/pages/teachers/videos-and-tasks/studentTasksDashboard"])}onFilterChange(){this.getPDFiles()}static \u0275fac=function(e){return new(e||n)(w(D),w(et),w(F),w(be))};static \u0275cmp=M({type:n,selectors:[["app-tasks"]],features:[B([F])],decls:7,vars:2,consts:[["header",""],["grid",""],[1,"card"],[3,"layout","value"],[1,"filters-container"],["variant","on",1,"filter-item"],["pInputText","","id","taskName","autocomplete","off",2,"width","100%",3,"ngModelChange","ngModel"],["for","taskName",2,"font-size","large"],["Class","pi pi-search"],["variant","on",1,"w-full","md:w-56","filter-item"],["inputId","academicLevel","optionLabel","academicLevelName","optionValue","academicLevelID","styleClass","w-full",3,"ngModelChange","ngModel","options"],["for","academicLevel",2,"font-size","large"],[1,"CheckBox"],[3,"ngModelChange","ngModel","binary"],["for","ny",1,"ml-3"],[1,"grid","grid-cols-12","gap-4"],["class","col-span-12 sm:col-span-6 md:col-span-4 xl:col-span-6 p-2",4,"ngFor","ngForOf"],[1,"col-span-12","sm:col-span-6","md:col-span-4","xl:col-span-6","p-2"],[1,"p-6","border","border-surface-200","dark:border-surface-700","bg-surface-0","dark:bg-surface-900","rounded","flex","flex-col"],[1,"bg-surface-50","flex","justify-center","rounded","p-4"],[1,"relative","mx-auto"],[1,"rounded","w-full",2,"max-width","300px",3,"src","alt"],[1,"pt-6"],[1,"flex","flex-row","justify-between","products-start","gap-2"],[1,"font-medium","text-surface-500","dark:text-surface-400","text-sm"],[1,"text-lg","font-medium","mt-1"],[1,"flex","flex-row-reverse","gap-2","pb-4"],["pButton","","icon","pi pi-check-circle",3,"outlined","routerLink"],[1,"flex","flex-row","gap-2"],["pButton","","icon","pi pi-clipboard","label","Download Task",1,"flex-1","whitespace-nowrap",2,"height","40px",3,"click"],[1,"flex-1"],["name","file","customUpload","true","mode","basic","chooseLabel","Upload Solving","chooseIcon","pi pi-file-check",1,"whitespace-nowrap",3,"uploadHandler","auto","disabled","accept"]],template:function(e,o){e&1&&(a(0,"div",2)(1,"p-dataview",3),h(2,It,14,5,"ng-template",null,0,b)(4,Mt,2,1,"ng-template",null,1,b),l(),f(6,"p-toast"),l()),e&2&&(p(),d("layout","grid")("value",o.tasksFiles))},dependencies:[Le,W,pe,T,J,P,L,N,A,ce,me,$,Z,Se,ye,te,ee,O,z,R,U,G,j,Ve,Ie],styles:[".p-fileupload-basic{display:inline!important;width:100%!important}.filters-container[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:1rem}.filter-item[_ngcontent-%COMP%]{flex:1}.CheckBox[_ngcontent-%COMP%]{padding-bottom:10px;font-size:large;display:flex}"]})};var Tt=()=>["tasks"],Ft=()=>["videos"],Dt=()=>["uploadTasks"],Et=()=>["uploadVideos"],Lt=()=>["chapters"],ze=class n{constructor(){}ngOnInit(){}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=M({type:n,selectors:[["app-layout-videos-and-tasks"]],decls:23,vars:15,consts:[["value","tasks"],[3,"value","routerLink"],[1,"pi","pi-file-pdf"],[1,"pi","pi-video"],[1,"pi","pi-cloud-upload"],[1,"pi","pi-bookmark-fill"]],template:function(e,o){e&1&&(a(0,"p-tabs",0)(1,"p-tablist")(2,"p-tab",1),f(3,"i",2),a(4,"span"),m(5,"Tasks"),l()(),a(6,"p-tab",1),f(7,"i",3),a(8,"span"),m(9,"Videos"),l()(),a(10,"p-tab",1),f(11,"i",4),a(12,"span"),m(13,"Upload Tasks"),l()(),a(14,"p-tab",1),f(15,"i",4),a(16,"span"),m(17,"Upload Videos"),l()(),a(18,"p-tab",1),f(19,"i",5),a(20,"span"),m(21,"Chapters"),l()()()(),f(22,"router-outlet")),e&2&&(p(2),d("value","tasks")("routerLink",S(10,Tt)),p(4),d("value","videos")("routerLink",S(11,Ft)),p(4),d("value","uploadTasks")("routerLink",S(12,Dt)),p(4),d("value","uploadVideos")("routerLink",S(13,Et)),p(4),d("value","chapters")("routerLink",S(14,Lt)))},dependencies:[ft,gt,ut,_t,T,Se,tt,ye],encapsulation:2})};function Nt(n,i){if(n&1){let e=y();a(0,"div",5)(1,"p-floatlabel",6)(2,"input",7),x("ngModelChange",function(t){c(e);let r=s();return C(r.Filter.videoName,t)||(r.Filter.videoName=t),u(t)}),_("ngModelChange",function(){c(e);let t=s();return u(t.onFilterChange())}),l(),a(3,"label",8),f(4,"p-inputicon",9),m(5," \u0627\u0633\u0645 \u0627\u0644\u0641\u062F\u064A\u0648"),l()(),a(6,"p-floatlabel",10)(7,"p-dropdown",11),x("ngModelChange",function(t){c(e);let r=s();return C(r.Filter.academicLevelId,t)||(r.Filter.academicLevelId=t),u(t)}),_("ngModelChange",function(){c(e);let t=s();return u(t.onFilterChange())}),l(),a(8,"label",12),m(9,"\u0627\u0644\u0645\u0631\u062D\u0644\u0629 \u0627\u0644\u062F\u0631\u0627\u0633\u064A\u0629"),l()()()}if(n&2){let e=s();p(2),v("ngModel",e.Filter.videoName),p(5),v("ngModel",e.Filter.academicLevelId),d("options",e.academicLevelData)}}function At(n,i){if(n&1){let e=y();a(0,"div",15)(1,"div",16)(2,"div",17)(3,"div",18),f(4,"img",19),l()(),a(5,"div",20)(6,"div",21)(7,"div")(8,"span",22),m(9,"video"),l(),a(10,"div",23),m(11),l()()(),a(12,"div",24)(13,"div",25)(14,"button",26),_("click",function(){let t=c(e).$implicit,r=s(2);return u(r.viewVideo(t.videoName))}),l()()()()()()}if(n&2){let e=i.$implicit;p(4),d("src","assets/File/Videos3.png",Y)("alt","img not fount"),p(7),I(e==null||e.videoName==null?null:e.videoName.replace(".mp4",""))}}function Pt(n,i){if(n&1&&(a(0,"div",13),h(1,At,15,3,"div",14),l()),n&2){let e=s();p(),d("ngForOf",e.videosData)}}var Oe=class n{constructor(i,e,o){this.tasksAndVideos=i;this.productService=e;this.router=o;let t=sessionStorage.getItem("teacherId");t&&(this.teacherId=t);let r=sessionStorage.getItem("chapterId");r&&(this.chapterId=+r)}academicLevelData=[];Filter;teacherId;academicLevelId=4;videosData=[];chapterId;ngOnInit(){this.Filter={teacherId:this.teacherId,chapterId:this.chapterId,academicLevelId:this.academicLevelId,pageNumber:1,pageSize:25},this.getVideos(),this.getAcademicLevelFilter()}getAcademicLevelFilter(){this.tasksAndVideos.getAllAcademicLevels().subscribe({next:i=>{this.academicLevelData=i}})}onFilterChange(){this.getVideos()}getVideos(){this.tasksAndVideos.getTeachersVideos(this.Filter).subscribe({next:i=>{this.videosData=i.items},error:i=>{console.error("Error fetching teachers:",i)}})}viewVideo(i){sessionStorage.setItem("videoName",i),this.router.navigate(["/pages/teachers/videos-and-tasks/VideoPlayer"])}static \u0275fac=function(e){return new(e||n)(w(D),w(Fe),w(be))};static \u0275cmp=M({type:n,selectors:[["app-videos"]],features:[B([Fe])],decls:7,vars:2,consts:[["dv",""],["header",""],["grid",""],[1,"card"],[3,"value","layout"],[1,"filters-container"],["variant","on",1,"filter-item"],["pInputText","","id","VideoName","autocomplete","off",2,"width","100%",3,"ngModelChange","ngModel"],["for","VideoName",2,"font-size","large"],["Class","pi pi-search"],["variant","on",1,"w-full","md:w-56","filter-item"],["inputId","academicLevel","optionLabel","academicLevelName","optionValue","academicLevelID","styleClass","w-full",3,"ngModelChange","ngModel","options"],["for","academicLevel",2,"font-size","large"],[1,"grid","grid-cols-12","gap-4"],["class","col-span-12 sm:col-span-6 md:col-span-4 xl:col-span-6 p-2",4,"ngFor","ngForOf"],[1,"col-span-12","sm:col-span-6","md:col-span-4","xl:col-span-6","p-2"],[1,"p-6","border","border-surface-200","dark:border-surface-700","bg-surface-0","dark:bg-surface-900","rounded","flex","flex-col"],[1,"bg-surface-50","flex","justify-center","rounded","p-4"],[1,"relative","mx-auto"],[1,"rounded","w-full",2,"max-width","300px",3,"src","alt"],[1,"pt-6"],[1,"flex","flex-row","justify-between","products-start","gap-2"],[1,"font-medium","text-surface-500","dark:text-surface-400","text-sm"],[1,"text-lg","font-medium","mt-1"],[1,"flex","flex-col","gap-6","mt-6"],[1,"flex","gap-2"],["pButton","","icon","pi pi-video","label","Watch",1,"flex-auto","whitespace-nowrap",3,"click"]],template:function(e,o){e&1&&(a(0,"div",3)(1,"p-dataview",4,0),h(3,Nt,10,3,"ng-template",null,1,b)(5,Pt,2,1,"ng-template",null,2,b),l()()),e&2&&(p(),d("value",o.videosData)("layout","grid"))},dependencies:[Le,W,pe,T,J,P,L,N,A,O,z,te,ee,G,j,R,U],styles:[".filters-container[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:1rem}.filter-item[_ngcontent-%COMP%]{flex:1}"]})};var Rt=()=>({width:"1000px",height:"600px"}),Bt=()=>({"min-width":"50rem"});function Wt(n,i){if(n&1){let e=y();a(0,"div",17)(1,"div",18)(2,"p-button",19),_("onClick",function(t){let r=c(e).chooseCallback,g=s();return u(g.choose(t,r))}),l(),a(3,"p-button",20),_("onClick",function(){c(e);let t=s();return u(t.uploadEvent())}),l()(),a(4,"p-progressbar",21)(5,"span",22),m(6),l()()()}if(n&2){let e=i.$implicit,o=s();p(2),d("rounded",!0)("outlined",!0)("disabled",(e==null?null:e.length)>0),p(),d("rounded",!0)("outlined",!0)("disabled",!e||e.length===0),p(),d("value",o.totalSizePercent)("showValue",!1),p(2),q("",o.totalSize,"B / 1Mb")}}function zt(n,i){n&1&&f(0,"p-badge",31)}function Ot(n,i){n&1&&f(0,"p-badge",32)}function jt(n,i){if(n&1){let e=y();a(0,"div",26)(1,"div"),f(2,"img",27),l(),a(3,"span",28),m(4),l(),a(5,"div"),m(6),l(),h(7,zt,1,0,"p-badge",29)(8,Ot,1,0,"ng-template",null,4,b),a(10,"p-button",30),_("click",function(t){let r=c(e),g=r.$implicit,V=r.index,E=s(2).removeFileCallback,he=s();return u(he.onRemoveTemplatingFile(t,g,E,V))}),l()()}if(n&2){let e=i.$implicit,o=oe(9),t=s(3);p(2),d("alt",e.name)("src","assets/File/PDFile.png",Y),p(2),I(e.name),p(2),I(t.formatSize(e.size)),p(),d("ngIf",t.isPending)("ngIfElse",o),p(3),d("outlined",!0)("rounded",!0)}}function Gt(n,i){if(n&1&&(a(0,"div")(1,"h5"),m(2,"Pending"),l(),a(3,"div",24),h(4,jt,11,8,"div",25),l()()),n&2){let e=s().$implicit;p(4),d("ngForOf",e)}}function Ht(n,i){if(n&1&&(a(0,"div",23),h(1,Gt,5,1,"div",16),l()),n&2){let e=i.$implicit;p(),d("ngIf",(e==null?null:e.length)>0)}}function Kt(n,i){}function Yt(n,i){n&1&&(a(0,"div",33),f(1,"i",34),a(2,"p",35),m(3,"Drag and drop files to here to upload."),l()())}function qt(n,i){n&1&&(a(0,"div",49),m(1,"\u0627\u0636\u0627\u0641\u0647 \u0641\u0635\u0644"),l())}function Jt(n,i){n&1&&f(0,"p-toast")}function Qt(n,i){n&1&&(a(0,"tr")(1,"th"),m(2,"\u0627\u0633\u0645 \u0627\u0644\u0641\u0635\u0644"),l(),a(3,"th"),m(4,"\u0627\u0633\u0645 \u0627\u0644\u0645\u0631\u062D\u0644\u0647 \u0627\u0644\u062F\u0631\u0627\u0633\u064A\u0647"),l()())}function Xt(n,i){if(n&1&&(a(0,"tr",50)(1,"td"),m(2),l(),a(3,"td"),m(4),l()()),n&2){let e=i.$implicit;d("pSelectableRow",e),p(2),I(e.chapterName),p(2),I(e.academicLevelId)}}function Zt(n,i){if(n&1){let e=y();a(0,"div")(1,"p-dialog",36),x("visibleChange",function(t){c(e);let r=s();return C(r.displayDialog,t)||(r.displayDialog=t),u(t)}),h(2,qt,2,0,"ng-template",37),a(3,"div",38)(4,"p-floatlabel",39)(5,"input",40),x("ngModelChange",function(t){c(e);let r=s();return C(r.Filter.chapterName,t)||(r.Filter.chapterName=t),u(t)}),_("ngModelChange",function(){c(e);let t=s();return u(t.onFilterChange())}),l(),a(6,"label",41),m(7," \u0627\u0633\u0645 \u0627\u0644\u0641\u0635\u0644 "),l()(),a(8,"p-floatlabel",42)(9,"p-dropdown",43),x("ngModelChange",function(t){c(e);let r=s();return C(r.Filter.academicLevelId,t)||(r.Filter.academicLevelId=t),u(t)}),_("ngModelChange",function(){c(e);let t=s();return u(t.onFilterChange())}),l(),a(10,"label",44),m(11,"\u0627\u0644\u0645\u0631\u062D\u0644\u0629 \u0627\u0644\u062F\u0631\u0627\u0633\u064A\u0629"),l()()(),a(12,"div",6),h(13,Jt,1,0,"p-toast",16),a(14,"p-table",45),x("selectionChange",function(t){c(e);let r=s();return C(r.selectedChapter,t)||(r.selectedChapter=t),u(t)}),_("onRowSelect",function(t){c(e);let r=s();return u(r.onRowSelect(t))}),h(15,Qt,5,0,"ng-template",null,0,b)(17,Xt,5,3,"ng-template",null,5,b),l()(),a(19,"div",46)(20,"p-button",47),_("click",function(){c(e);let t=s();return u(t.displayDialog=!1)}),l(),a(21,"p-button",48),_("click",function(){c(e);let t=s();return u(t.displayDialog=!1)}),l()()()()}if(n&2){let e=s();p(),K(S(11,Rt)),d("modal",!0),v("visible",e.displayDialog),p(4),v("ngModel",e.Filter.chapterName),p(4),v("ngModel",e.Filter.academicLevelId),d("options",e.academicLevelData),p(4),d("ngIf",e.displayDialog),p(),d("value",e.Chapters),v("selection",e.selectedChapter),d("tableStyle",S(12,Bt))}}function $t(n,i){n&1&&f(0,"p-toast")}var je=class n{constructor(i,e,o,t){this.config=i;this.messageService=e;this.tasksAndVideos=o;this.chapters=t;let r=sessionStorage.getItem("teacherId");r&&(this.teacherId=+r)}files=[];chapterId;totalSize=0;totalSizePercent=0;teacherId;userId=1;taskName;academicLevelID;isBook=!1;academicLevelData=[];uploadedFiles=[];isPending=!0;Chapters=[];Filter;displayDialog=!1;selectedChapter;ngOnInit(){this.Filter={teacherId:this.teacherId.toString(),pageNumber:1,pageSize:25}}choose(i,e){this.isPending=!0,e&&e()}onRemoveTemplatingFile(i,e,o,t){o&&o(i,t),this.totalSize-=e.size,this.totalSizePercent=this.totalSize/10}onClearTemplatingUpload(i){i&&i(),this.totalSize=0,this.totalSizePercent=0}onSelectedFiles(i){this.files=i.currentFiles||[],this.totalSize=this.files.reduce((e,o)=>e+o.size,0),this.totalSizePercent=this.totalSize/10}uploadEvent(){if(!this.taskName||!this.chapterId){this.messageService.add({severity:"warn",summary:"\u062A\u0646\u0628\u064A\u0647",detail:"\u064A\u0631\u062C\u0649 \u062A\u062D\u062F\u064A\u062F \u0627\u0633\u0645 \u0627\u0644\u062A\u0627\u0633\u0643 \u0648\u0627\u0633\u0645 \u0627\u0644\u0641\u0635\u0644 \u0642\u0628\u0644 \u0627\u0644\u0631\u0641\u0639."});return}if(!this.files.length)return;let i=this.files[0],e=new FormData;e.append("file",i),e.append("userId",this.userId.toString()),e.append("teacherId",this.teacherId.toString()),e.append("isAnswer","false"),e.append("taskName",this.taskName),e.append("chapterId",this.chapterId.toString()),e.append("IsBook",this.isBook.toString()),this.tasksAndVideos.uploadFile(e).subscribe({next:o=>{o.isValidTransaction?(this.messageService.add({severity:"success",summary:"\u0646\u062C\u0627\u062D",detail:"\u062A\u0645 \u0631\u0641\u0639 \u0627\u0644\u0645\u0644\u0641 \u0628\u0646\u062C\u0627\u062D!"}),this.files=[],this.isPending=!1):this.messageService.add({severity:"error",summary:"\u062E\u0637\u0623",detail:o.transactionDetails})},error:o=>{this.messageService.add({severity:"error",summary:"\u062E\u0637\u0623",detail:"\u0641\u0634\u0644 \u0641\u064A \u0631\u0641\u0639 \u0627\u0644\u0645\u0644\u0641!"})}})}formatSize(i){if(!this.config.translation||!this.config.translation.fileSizeTypes)return`${i} B`;let e=1024,o=3,t=this.config.translation.fileSizeTypes;if(i===0)return`0 ${t[0]}`;let r=Math.floor(Math.log(i)/Math.log(e));return`${parseFloat((i/Math.pow(e,r)).toFixed(o))} ${t[r]||"B"}`}getAcademicLevelFilter(){this.tasksAndVideos.getAllAcademicLevels().subscribe({next:i=>{this.academicLevelData=i}})}getChapterData(){this.chapters.getAllChapters(this.Filter).subscribe({next:i=>{this.Chapters=i.items},error:i=>{console.error("Error fetching teachers:",i)}})}onFilterChange(){this.getChapterData()}showDialog(){this.getChapterData(),this.getAcademicLevelFilter(),this.displayDialog=!0}onRowSelect(i){this.chapterId=i.data.chapterID,this.messageService.add({severity:"info",summary:"\u062A\u0645 \u0627\u062E\u062A\u064A\u0627\u0631 \u0627\u0644\u0641\u0635\u0644",detail:i.data.name})}static \u0275fac=function(e){return new(e||n)(w(it),w(F),w(D),w(ge))};static \u0275cmp=M({type:n,selectors:[["app-upload-tasks"]],features:[B([F])],decls:22,vars:6,consts:[["header",""],["content",""],["file",""],["empty",""],["templateName",""],["body",""],[1,"card"],[1,"filters-container"],["variant","on",1,"filter-item"],["pInputText","","id","on_label","autocomplete","off",2,"width","100%",3,"ngModelChange","ngModel"],["for","on_label",2,"font-size","large"],["label","\u0627\u062E\u062A\u0631 \u0627\u0644\u0641\u0635\u0644","icon","pi pi-plus",1,"add-chapter-btn",3,"click"],[1,"CheckBox"],[3,"ngModelChange","ngModel","binary"],["for","ny",1,"ml-3"],["accept","application/pdf","maxFileSize","1000000",3,"onSelect","multiple"],[4,"ngIf"],[1,"flex","flex-wrap","justify-between","items-center","flex-1","gap-4"],[1,"flex","gap-2"],["icon","pi pi-images",3,"onClick","rounded","outlined","disabled"],["icon","pi pi-cloud-upload","severity","success",3,"onClick","rounded","outlined","disabled"],["styleClass","md:w-20rem h-1 w-full md:ml-auto",1,"w-full",3,"value","showValue"],[1,"whitespace-nowrap"],[1,"flex","flex-col","gap-8","pt-4"],[1,"flex","flex-wrap","gap-4"],["class","p-8 rounded-border flex flex-col border border-surface items-center gap-4",4,"ngFor","ngForOf"],[1,"p-8","rounded-border","flex","flex-col","border","border-surface","items-center","gap-4"],["role","presentation","width","100","height","50",3,"alt","src"],[1,"font-semibold","text-ellipsis","max-w-60","whitespace-nowrap","overflow-hidden"],["value","Pending","severity","warn",4,"ngIf","ngIfElse"],["icon","pi pi-times","severity","danger",3,"click","outlined","rounded"],["value","Pending","severity","warn"],["value","Completed","severity","success",1,"mt-4"],[1,"flex","items-center","justify-center","flex-col"],[1,"pi","pi-cloud-upload","!border-2","!rounded-full","!p-8","!text-4xl","!text-muted-color"],[1,"mt-6","mb-0"],["header","\u0627\u0636\u0627\u0641\u0647 \u0641\u0635\u0644",3,"visibleChange","modal","visible"],["pTemplate","header"],[1,"flex","items-center","gap-4","mb-4","mt-4"],["variant","on",1,"filter-item",2,"margin-top","10px"],["pInputText","","id","taskName","autocomplete","off",2,"width","100%",3,"ngModelChange","ngModel"],["for","taskName",2,"font-size","large"],["variant","on",1,"w-full","md:w-56","filter-item",2,"margin-top","10px"],["inputId","academicLevel","optionLabel","academicLevelName","optionValue","academicLevelID","styleClass","w-full",3,"ngModelChange","ngModel","options"],["for","academicLevel",2,"font-size","large"],["selectionMode","single","dataKey","chapterID",3,"selectionChange","onRowSelect","value","selection","tableStyle"],[1,"flex","justify-end","gap-2",2,"margin-top","50px"],["label","Cancel","severity","secondary",3,"click"],["label","Save","severity","success",3,"click"],[1,"custom-header"],[3,"pSelectableRow"]],template:function(e,o){if(e&1){let t=y();a(0,"div",6)(1,"div",7)(2,"p-floatlabel",8)(3,"input",9),x("ngModelChange",function(g){return c(t),C(o.taskName,g)||(o.taskName=g),u(g)}),l(),a(4,"label",10),m(5,"\u0627\u0633\u0645 \u0627\u0644\u062A\u0627\u0633\u0643"),l()(),a(6,"p-button",11),_("click",function(){return c(t),u(o.showDialog())}),l()(),a(7,"div",12)(8,"p-checkbox",13),x("ngModelChange",function(g){return c(t),C(o.isBook,g)||(o.isBook=g),u(g)}),l(),a(9,"label",14),m(10,"Is Book "),l()(),a(11,"p-fileupload",15),_("onSelect",function(g){return c(t),u(o.onSelectedFiles(g))}),h(12,Wt,7,9,"ng-template",null,0,b)(14,Ht,2,1,"ng-template",null,1,b)(16,Kt,0,0,"ng-template",null,2,b)(18,Yt,4,0,"ng-template",null,3,b),l()(),h(20,Zt,22,13,"div",16)(21,$t,1,0,"p-toast",16)}e&2&&(p(3),v("ngModel",o.taskName),p(5),v("ngModel",o.isBook),d("binary",!0),p(3),d("multiple",!1),p(9),d("ngIf",o.displayDialog),p(),d("ngIf",!o.displayDialog))},dependencies:[me,W,de,le,se,ke,De,ne,ie,Te,$,Z,we,T,J,Q,R,U,_e,ue,P,L,N,A,Ee,O,z,G,j,Ve,Ie],styles:[".filters-container[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:1rem}.filter-item[_ngcontent-%COMP%]{flex:1}.CheckBox[_ngcontent-%COMP%]{padding-bottom:20px;font-size:large;display:flex}"]})};var ei=()=>[10,25,50],ti=()=>({"min-width":"75rem"});function ii(n,i){if(n&1){let e=y();a(0,"tr")(1,"th",6),m(2,"#"),l(),a(3,"th",7),m(4,"Answer Name "),l(),a(5,"th",8),m(6,"Student Name"),l(),a(7,"th",8),m(8,"Academic Level Name"),l(),a(9,"th",9),m(10,"Download Answer"),l()(),a(11,"tr"),f(12,"th"),a(13,"th")(14,"p-iconfield",10)(15,"p-inputicon"),f(16,"i",11),l(),a(17,"input",12),x("ngModelChange",function(t){c(e);let r=s();return C(r.Filter.AnswerName,t)||(r.Filter.AnswerName=t),u(t)}),_("ngModelChange",function(){c(e);let t=s();return u(t.onFilterChange())}),l()()(),a(18,"th")(19,"p-iconfield",10)(20,"p-inputicon"),f(21,"i",11),l(),a(22,"input",13),x("ngModelChange",function(t){c(e);let r=s();return C(r.Filter.StudentName,t)||(r.Filter.StudentName=t),u(t)}),_("ngModelChange",function(){c(e);let t=s();return u(t.onFilterChange())}),l()()(),a(23,"th")(24,"p-iconfield",10)(25,"p-inputicon"),f(26,"i",11),l(),a(27,"input",13),x("ngModelChange",function(t){c(e);let r=s();return C(r.Filter.AcademicLevelName,t)||(r.Filter.AcademicLevelName=t),u(t)}),_("ngModelChange",function(){c(e);let t=s();return u(t.onFilterChange())}),l()()(),f(28,"th"),l()}if(n&2){let e=s();p(17),v("ngModel",e.Filter.AnswerName),p(5),v("ngModel",e.Filter.StudentName),p(5),v("ngModel",e.Filter.AcademicLevelName)}}function ni(n,i){if(n&1){let e=y();a(0,"tr")(1,"td",14),m(2),l(),a(3,"td",14),m(4),l(),a(5,"td",14),m(6),l(),a(7,"td",14),m(8),l(),a(9,"td",14)(10,"button",15),_("click",function(){let t=c(e).$implicit,r=s();return u(r.downloadTask(t.fileName))}),f(11,"i",16),m(12," Download "),l()()()}if(n&2){let e=i.$implicit,o=i.rowIndex;p(2),I(o+1),p(2),I(e.answerName),p(2),I(e.studentId),p(2),I(e.academicLevelName)}}function oi(n,i){n&1&&(a(0,"tr")(1,"td",17),m(2,"No Data found."),l()())}var Ge=class n{constructor(i){this.tasksAndVideos=i;let e=sessionStorage.getItem("teacherId");e&&(this.teacherId=+e);let o=sessionStorage.getItem("fileId");o&&(this.fileId=+o)}studentAnswer=[];academicLevelId=4;studentAnswerData;teacherId;loading=!0;fileId;Filter;ngOnInit(){this.Filter={teacherId:this.teacherId,filesId:this.fileId,pageNumber:1,pageSize:25},this.getStudentAnswer()}getStudentAnswer(){this.tasksAndVideos.getStudentAnswer(this.Filter).subscribe({next:i=>{this.studentAnswerData=i.items,console.log("\u{1F680} ~ TasksComponent ~ this.tasksAndVideos.getStudentAnswer ~ this.tasksAndVideos:",this.studentAnswerData),this.loading=!1},error:i=>{console.error("Error fetching StudentAnswer:",i),this.loading=!1}})}onFilterChange(){this.getStudentAnswer()}downloadTask(i){this.tasksAndVideos.downloadFile(i).subscribe({next:e=>{let o=new Blob([e.body],{type:e.body?.type}),t=e.headers.get("Content-Disposition"),r=i;if(t){let E=t.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/);E&&E[1]&&(r=E[1].replace(/['"]/g,""))}let g=window.URL.createObjectURL(o),V=document.createElement("a");V.href=g,V.download=r,V.click(),window.URL.revokeObjectURL(g)},error:e=>{console.error("Error downloading file:",e)}})}static \u0275fac=function(e){return new(e||n)(w(D))};static \u0275cmp=M({type:n,selectors:[["app-student-tasks-dashboard"]],decls:9,vars:8,consts:[["dt2",""],["header",""],["body",""],["emptymessage",""],[1,"card"],["dataKey","id",3,"value","rows","rowsPerPageOptions","loading","paginator","tableStyle"],[2,"width","5%"],[2,"width","30%"],[2,"width","22%"],[2,"width","15%"],["iconPosition","left",1,"ml-auto"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Seaprch keyword",3,"ngModelChange","ngModel"],["pInputText","","type","text","placeholder","Search keyword",3,"ngModelChange","ngModel"],[1,"text-center"],[1,"bg-green-500","hover:bg-green-600","text-white","py-2","px-4","rounded","flex","items-center","gap-2",3,"click"],[1,"pi","pi-clipboard"],["colspan","5"]],template:function(e,o){e&1&&(a(0,"div",4)(1,"p-table",5,0),h(3,ii,29,3,"ng-template",null,1,b)(5,ni,13,4,"ng-template",null,2,b)(7,oi,3,0,"ng-template",null,3,b),l()()),e&2&&(p(),d("value",o.studentAnswerData)("rows",o.Filter.pageSize)("rowsPerPageOptions",S(6,ei))("loading",o.loading)("paginator",!0)("tableStyle",S(7,ti)))},dependencies:[ce,ne,ie,Ne,ot,nt,R,U,te,ee,Ee,Me,we,T,P,L,N,A],encapsulation:2})};var ri=()=>({width:"1000px",height:"600px"}),li=()=>({"min-width":"50rem"});function si(n,i){if(n&1){let e=y();a(0,"div",14)(1,"div",15)(2,"p-button",16),_("onClick",function(t){let r=c(e).chooseCallback,g=s();return u(g.choose(t,r))}),l(),a(3,"p-button",17),_("onClick",function(){c(e);let t=s();return u(t.uploadVideo())}),l(),a(4,"p-button",18),_("onClick",function(){let t=c(e).clearCallback,r=s();return u(r.resetVideoSelection(t))}),l()(),f(5,"p-progressbar",19),l()}if(n&2){let e=i.$implicit,o=s();p(2),d("rounded",!0)("outlined",!0)("disabled",(e==null?null:e.length)>0),p(),d("rounded",!0)("outlined",!0)("disabled",!o.selectedVideo),p(),d("rounded",!0)("outlined",!0)("disabled",!e||e.length===0),p(),d("value",o.uploadProgress)("showValue",!1)}}function pi(n,i){n&1&&(a(0,"h5"),m(1,"Pending"),l())}function di(n,i){n&1&&(a(0,"h5"),m(1," Completed "),l())}function mi(n,i){if(n&1&&h(0,di,2,0,"h5",21),n&2){s();let e=oe(5),o=s(2);d("ngIf",o.isPending===2)("ngIfElse",e)}}function ci(n,i){n&1&&(a(0,"h5"),m(1," Error "),l())}function ui(n,i){if(n&1&&h(0,ci,2,0,"h5",13),n&2){let e=s(3);d("ngIf",e.isPending===3)}}function _i(n,i){n&1&&f(0,"p-badge",29)}function gi(n,i){n&1&&f(0,"p-badge",31)}function fi(n,i){if(n&1&&h(0,gi,1,0,"p-badge",30),n&2){s();let e=oe(10),o=s(3);d("ngIf",o.isPending===2)("ngIfElse",e)}}function hi(n,i){n&1&&f(0,"p-badge",33)}function vi(n,i){if(n&1&&h(0,hi,1,0,"p-badge",32),n&2){let e=s(4);d("ngIf",e.isPending===3)}}function Ci(n,i){if(n&1){let e=y();a(0,"div",24),f(1,"i",25),a(2,"span",26),m(3),l(),a(4,"div"),m(5),l(),h(6,_i,1,0,"p-badge",27)(7,fi,1,2,"ng-template",null,3,b)(9,vi,1,1,"ng-template",null,4,b),a(11,"p-button",28),_("click",function(){let t=c(e).index,r=s(2).removeFileCallback,g=s();return u(g.onRemoveVideo(r,t))}),l()()}if(n&2){let e=i.$implicit,o=oe(8),t=s(3);p(3),q(" ",e.name," "),p(2),I(t.formatSize(e.size)),p(),d("ngIf",t.isPending===1)("ngIfElse",o),p(5),d("outlined",!0)("rounded",!0)}}function xi(n,i){if(n&1&&(a(0,"div"),h(1,pi,2,0,"h5",21)(2,mi,1,2,"ng-template",null,3,b)(4,ui,1,1,"ng-template",null,4,b),a(6,"div",22),h(7,Ci,12,6,"div",23),l()()),n&2){let e=oe(3),o=s().$implicit,t=s();p(),d("ngIf",t.isPending===1)("ngIfElse",e),p(6),d("ngForOf",o)}}function wi(n,i){if(n&1&&(a(0,"div",20),h(1,xi,8,3,"div",13),l()),n&2){let e=i.$implicit;p(),d("ngIf",(e==null?null:e.length)>0)}}function bi(n,i){n&1&&(a(0,"div",34),f(1,"i",35),a(2,"p",36),m(3,"\u0627\u0633\u062D\u0628 \u0627\u0644\u0641\u064A\u062F\u064A\u0648 \u0647\u0646\u0627 \u0623\u0648 \u0627\u062E\u062A\u0631\u0647 \u0645\u0646 \u062C\u0647\u0627\u0632\u0643."),l()())}function yi(n,i){n&1&&(a(0,"div",50),m(1,"\u0627\u0636\u0627\u0641\u0647 \u0641\u0635\u0644"),l())}function Si(n,i){n&1&&f(0,"p-toast")}function ki(n,i){n&1&&(a(0,"tr")(1,"th"),m(2,"\u0627\u0633\u0645 \u0627\u0644\u0641\u0635\u0644"),l(),a(3,"th"),m(4,"\u0627\u0633\u0645 \u0627\u0644\u0645\u0631\u062D\u0644\u0647 \u0627\u0644\u062F\u0631\u0627\u0633\u064A\u0647"),l()())}function Ii(n,i){if(n&1&&(a(0,"tr",51)(1,"td"),m(2),l(),a(3,"td"),m(4),l()()),n&2){let e=i.$implicit;d("pSelectableRow",e),p(2),I(e.chapterName),p(2),I(e.academicLevelId)}}function Vi(n,i){if(n&1){let e=y();a(0,"div")(1,"p-dialog",37),x("visibleChange",function(t){c(e);let r=s();return C(r.displayDialog,t)||(r.displayDialog=t),u(t)}),h(2,yi,2,0,"ng-template",38),a(3,"div",39)(4,"p-floatlabel",40)(5,"input",41),x("ngModelChange",function(t){c(e);let r=s();return C(r.Filter.chapterName,t)||(r.Filter.chapterName=t),u(t)}),_("ngModelChange",function(){c(e);let t=s();return u(t.onFilterChange())}),l(),a(6,"label",42),m(7," \u0627\u0633\u0645 \u0627\u0644\u0641\u0635\u0644 "),l()(),a(8,"p-floatlabel",43)(9,"p-dropdown",44),x("ngModelChange",function(t){c(e);let r=s();return C(r.Filter.academicLevelId,t)||(r.Filter.academicLevelId=t),u(t)}),_("ngModelChange",function(){c(e);let t=s();return u(t.onFilterChange())}),l(),a(10,"label",45),m(11,"\u0627\u0644\u0645\u0631\u062D\u0644\u0629 \u0627\u0644\u062F\u0631\u0627\u0633\u064A\u0629"),l()()(),a(12,"div",6),h(13,Si,1,0,"p-toast",13),a(14,"p-table",46),x("selectionChange",function(t){c(e);let r=s();return C(r.selectedChapter,t)||(r.selectedChapter=t),u(t)}),_("onRowSelect",function(t){c(e);let r=s();return u(r.onRowSelect(t))}),h(15,ki,5,0,"ng-template",null,0,b)(17,Ii,5,3,"ng-template",null,5,b),l()(),a(19,"div",47)(20,"p-button",48),_("click",function(){c(e);let t=s();return u(t.displayDialog=!1)}),l(),a(21,"p-button",49),_("click",function(){c(e);let t=s();return u(t.displayDialog=!1)}),l()()()()}if(n&2){let e=s();p(),K(S(11,ri)),d("modal",!0),v("visible",e.displayDialog),p(4),v("ngModel",e.Filter.chapterName),p(4),v("ngModel",e.Filter.academicLevelId),d("options",e.academicLevelData),p(4),d("ngIf",e.displayDialog),p(),d("value",e.Chapters),v("selection",e.selectedChapter),d("tableStyle",S(12,li))}}function Mi(n,i){n&1&&f(0,"p-toast")}var He=class n{constructor(i,e,o,t){this.chapters=i;this.tasksAndVideosService=e;this.messageService=o;this.confirmationService=t;let r=sessionStorage.getItem("teacherId");r&&(this.teacherId=r)}selectedVideo=null;chunkSize=5*1024*1024;uploadProgress=0;userId=1;teacherId;isPending;academicLevelData=[];VideoName;displayDialog=!1;Chapters=[];Filter;selectedChapter;chapterId;academicLevelID;ngOnInit(){this.Filter={teacherId:this.teacherId.toString(),pageNumber:1,pageSize:25},this.getAcademicLevelFilter()}getAcademicLevelFilter(){this.tasksAndVideosService.getAllAcademicLevels().subscribe({next:i=>{this.academicLevelData=i}})}onVideoSelected(i){this.selectedVideo=i.files[0]}uploadVideo(){return $e(this,null,function*(){if(!this.VideoName||!this.chapterId){this.messageService.add({severity:"warn",summary:"\u062A\u0646\u0628\u064A\u0647",detail:"\u064A\u0631\u062C\u0649 \u062A\u062D\u062F\u064A\u062F \u0627\u0633\u0645 \u0627\u0644\u0641\u062F\u064A\u0648 \u0648\u0627\u0633\u0645 \u0627\u0644\u0641\u0635\u0644 \u0642\u0628\u0644 \u0627\u0644\u0631\u0641\u0639."});return}if(!this.selectedVideo)return;let i=this.selectedVideo.name,e=Math.ceil(this.selectedVideo.size/this.chunkSize);try{let t=(yield this.checkUploadedChunks(i,this.userId)).length,r=(g=0)=>{if(t>=e){this.messageService.add({severity:"success",summary:"\u0646\u062C\u0627\u062D",detail:"\u062A\u0645 \u0631\u0641\u0639 \u0627\u0644\u0641\u064A\u062F\u064A\u0648 \u0628\u0646\u062C\u0627\u062D"}),this.selectedVideo=null,this.isPending=2,this.uploadProgress=100;return}this.isPending=1;let V=t*this.chunkSize,E=Math.min(V+this.chunkSize,this.selectedVideo.size),he=this.selectedVideo.slice(V,E),k=new FormData;k.append("FileName",i),k.append("Chunk",he),k.append("ChunkNumber",(t+1).toString()),k.append("TotalChunks",e.toString()),k.append("UserId",this.userId.toString()),k.append("TeacherId",this.teacherId),k.append("chapterId",this.chapterId.toString()),this.tasksAndVideosService.uploadFileChunk(k).subscribe({next:H=>{debugger;if(console.log("Server response:",H),t++,this.uploadProgress=Math.round(t/e*100),H?.isValidTransaction)r();else{this.messageService.add({severity:"error",summary:"\u062E\u0637\u0623",detail:H.transactionDetails}),this.uploadProgress=0,this.isPending=3;return}},error:H=>{debugger;console.error("Upload error:",H),(H.status===0||H.status===408||H.status>=500||g<3)&&g<3?(console.log(`Retrying chunk ${t+1}, attempt ${g+1}`),setTimeout(()=>{r(g+1)},Math.pow(2,g)*1e3)):(this.confirmationService.confirm({header:"\u062E\u0637\u0623",message:"\u0641\u0634\u0644 \u0631\u0641\u0639 \u0627\u0644\u0641\u064A\u062F\u064A\u0648. \u0642\u0645 \u0628\u0627\u0644\u0636\u063A\u0637 \u0639\u0644\u064A \u0632\u0631\u0627\u0631 \u0627\u0644\u0631\u0641\u0639 \u0645\u0631\u0647 \u0627\u062E\u0631\u064A.",icon:"pi pi-exclamation-triangle text-red-500 text-5xl",acceptVisible:!1,rejectVisible:!1,closeOnEscape:!0,closable:!0}),this.uploadProgress=0,this.isPending=3)}})};r()}catch{this.messageService.add({severity:"error",summary:"\u062E\u0637\u0623",detail:"\u0641\u0634\u0644 \u0627\u0644\u062A\u062D\u0642\u0642 \u0645\u0646 \u0627\u0644\u0623\u062C\u0632\u0627\u0621 \u0627\u0644\u0645\u0631\u0641\u0648\u0639\u0629"})}})}checkUploadedChunks(i,e){return new Promise((o,t)=>{this.tasksAndVideosService.checkUploadedChunks(e,i).subscribe({next:r=>{o(r.uploadedChunkNumbers||[])},error:r=>{t(r)}})})}choose(i,e){this.isPending=1,i.preventDefault(),e()}formatSize(i){if(i===0)return"0 Bytes";let e=1024,o=["Bytes","KB","MB","GB","TB"],t=Math.floor(Math.log(i)/Math.log(e));return`${parseFloat((i/Math.pow(e,t)).toFixed(2))} ${o[t]}`}onRemoveVideo(i,e){i(e),this.uploadProgress=0,this.selectedVideo=null}resetVideoSelection(i){i(),this.selectedVideo=null,this.uploadProgress=0,this.isPending=1}onFilterChange(){this.getChapterData()}showDialog(){this.getChapterData(),this.getAcademicLevelFilter(),this.displayDialog=!0}getChapterData(){this.chapters.getAllChapters(this.Filter).subscribe({next:i=>{this.Chapters=i.items},error:i=>{console.error("Error fetching teachers:",i)}})}onRowSelect(i){this.chapterId=i.data.chapterID,this.messageService.add({severity:"info",summary:"\u062A\u0645 \u0627\u062E\u062A\u064A\u0627\u0631 \u0627\u0644\u0641\u0635\u0644",detail:i.data.name})}static \u0275fac=function(e){return new(e||n)(w(ge),w(D),w(F),w(X))};static \u0275cmp=M({type:n,selectors:[["app-upload-videos"]],features:[B([F,X])],decls:17,vars:4,consts:[["header",""],["content",""],["empty",""],["templateCompleted",""],["templateError",""],["body",""],[1,"card"],[1,"filters-container"],["variant","on",1,"filter-item"],["pInputText","","id","VideoName","autocomplete","off",2,"width","100%",3,"ngModelChange","ngModel"],["for","VideoName",2,"font-size","large"],["label","\u0627\u062E\u062A\u0631 \u0627\u0644\u0641\u0635\u0644","icon","pi pi-plus",1,"add-chapter-btn",3,"click"],["accept","video/mp4","customUpload","true",3,"onSelect","multiple"],[4,"ngIf"],[1,"flex","flex-wrap","justify-between","items-center","flex-1","gap-4"],[1,"flex","gap-2"],["icon","pi pi-video",3,"onClick","rounded","outlined","disabled"],["icon","pi pi-cloud-upload","severity","success",3,"onClick","rounded","outlined","disabled"],["icon","pi pi-times","severity","danger",3,"onClick","rounded","outlined","disabled"],["styleClass","md:w-20rem h-1 w-full md:ml-auto",1,"w-full",3,"value","showValue"],[1,"flex","flex-col","gap-8","pt-4"],[4,"ngIf","ngIfElse"],[1,"flex","flex-wrap","gap-4"],["class","p-8 rounded-border flex flex-col border border-surface items-center gap-4",4,"ngFor","ngForOf"],[1,"p-8","rounded-border","flex","flex-col","border","border-surface","items-center","gap-4"],[1,"pi","pi-video","text-6xl"],[1,"font-semibold","text-ellipsis","max-w-60","whitespace-nowrap","overflow-hidden"],["value","Pending","severity","warn",4,"ngIf","ngIfElse"],["icon","pi pi-times","severity","danger",3,"click","outlined","rounded"],["value","Pending","severity","warn"],["value","Completed","class","mt-4","severity","success",4,"ngIf","ngIfElse"],["value","Completed","severity","success",1,"mt-4"],["value","Error","class","mt-4","severity","danger",4,"ngIf"],["value","Error","severity","danger",1,"mt-4"],[1,"flex","items-center","justify-center","flex-col"],[1,"pi","pi-video","!border-2","!rounded-full","!p-8","!text-4xl","!text-muted-color"],[1,"mt-6","mb-0"],["header","\u0627\u0636\u0627\u0641\u0647 \u0641\u0635\u0644",3,"visibleChange","modal","visible"],["pTemplate","header"],[1,"flex","items-center","gap-4","mb-4","mt-4"],["variant","on",1,"filter-item",2,"margin-top","10px"],["pInputText","","id","taskName","autocomplete","off",2,"width","100%",3,"ngModelChange","ngModel"],["for","taskName",2,"font-size","large"],["variant","on",1,"w-full","md:w-56","filter-item",2,"margin-top","10px"],["inputId","academicLevel","optionLabel","academicLevelName","optionValue","academicLevelID","styleClass","w-full",3,"ngModelChange","ngModel","options"],["for","academicLevel",2,"font-size","large"],["selectionMode","single","dataKey","chapterID",3,"selectionChange","onRowSelect","value","selection","tableStyle"],[1,"flex","justify-end","gap-2",2,"margin-top","50px"],["label","Cancel","severity","secondary",3,"click"],["label","Save","severity","success",3,"click"],[1,"custom-header"],[3,"pSelectableRow"]],template:function(e,o){if(e&1){let t=y();a(0,"div",6)(1,"div",7)(2,"p-floatlabel",8)(3,"input",9),x("ngModelChange",function(g){return c(t),C(o.VideoName,g)||(o.VideoName=g),u(g)}),l(),a(4,"label",10),m(5,"\u0627\u0633\u0645 \u0627\u0644\u0641\u062F\u064A\u0648"),l()(),a(6,"p-button",11),_("click",function(){return c(t),u(o.showDialog())}),l()(),a(7,"p-fileupload",12),_("onSelect",function(g){return c(t),u(o.onVideoSelected(g))}),h(8,si,6,11,"ng-template",null,0,b)(10,wi,2,1,"ng-template",null,1,b)(12,bi,4,0,"ng-template",null,2,b),l()(),h(14,Vi,22,13,"div",13),f(15,"p-confirmdialog"),h(16,Mi,1,0,"p-toast",13)}e&2&&(p(3),v("ngModel",o.VideoName),p(4),d("multiple",!1),p(7),d("ngIf",o.displayDialog),p(2),d("ngIf",!o.displayDialog))},dependencies:[T,J,Q,ce,me,le,O,z,G,j,ne,ie,Te,P,L,N,A,W,de,De,se,ke,$,Z,_e,ue,R,U,Pe,Ae],styles:[".filters-container[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:3rem}.filter-item[_ngcontent-%COMP%]{flex:1}"]})};function Ti(n,i){if(n&1&&(a(0,"video",6),f(1,"source",7),m(2," \u0645\u062A\u0635\u0641\u062D\u0643 \u0644\u0627 \u064A\u062F\u0639\u0645 \u062A\u0634\u063A\u064A\u0644 \u0627\u0644\u0641\u064A\u062F\u064A\u0648. "),l()),n&2){let e=s();p(),d("src",e.videoUrl,Y)}}var Ke=class n{constructor(i){this.tasksAndVideosService=i;let e=sessionStorage.getItem("videoName");e&&(this.videoName=e)}videoUrl;videoName;ngOnInit(){this.getVideoFile()}getVideoFile(){this.tasksAndVideosService.getVideoFile(this.videoName).subscribe({next:i=>{debugger;this.videoUrl=i.url,console.log("\u{1F680} ~ VideoPlayerComponent ~ this.tasksAndVideosService.getVideoById ~ this.videoUrl:",this.videoUrl)}})}static \u0275fac=function(e){return new(e||n)(w(D))};static \u0275cmp=M({type:n,selectors:[["app-video-player"]],decls:7,vars:2,consts:[[1,"justify-center","p-4"],[1,"w-full","h-full","w-full","md:w-8/12","shadow-2xl","rounded-2xl","overflow-hidden"],[1,"mt-4","flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-primary-600","flex-1","text-right"],[1,"video-container"],["width","100%","height","100%","controls","",4,"ngIf"],["width","100%","height","100%","controls",""],["type","video/mp4",3,"src"]],template:function(e,o){e&1&&(a(0,"div",0)(1,"p-card",1)(2,"div",2)(3,"h2",3),m(4),l()(),a(5,"div",4),h(6,Ti,3,1,"video",5),l()()()),e&2&&(p(4),q(" ",o.videoName.replace(".mp4","")," "),p(2),d("ngIf",o.videoUrl))},dependencies:[T,Q,vt,ht,se,dt,ct],styles:[".video-container[_ngcontent-%COMP%]{position:relative;width:100%;max-width:800px;margin:auto;padding:20px;background:#000;border-radius:10px;box-shadow:0 0 15px #0000004d}video[_ngcontent-%COMP%]{max-height:400px;object-fit:contain}"]})};var Fi=()=>({"min-width":"50rem"}),Di=()=>({width:"100%"}),Ei=()=>({width:"600px",height:"400px"});function Li(n,i){n&1&&(a(0,"tr")(1,"th",14),m(2,"\u0627\u0633\u0645 \u0627\u0644\u0641\u0635\u0644"),l(),a(3,"th",14),m(4,"\u0627\u0644\u0645\u0631\u062D\u0644\u0629 \u0627\u0644\u062F\u0631\u0627\u0633\u064A\u0629"),l(),f(5,"th",15)(6,"th",15),l())}function Ni(n,i){if(n&1){let e=y();a(0,"input",24),x("ngModelChange",function(t){c(e);let r=s().$implicit;return C(r.chapterName,t)||(r.chapterName=t),u(t)}),l()}if(n&2){let e=s().$implicit;v("ngModel",e.chapterName)}}function Ai(n,i){if(n&1&&m(0),n&2){let e=s().$implicit;q(" ",e.chapterName," ")}}function Pi(n,i){if(n&1){let e=y();a(0,"p-dropdown",25),x("ngModelChange",function(t){c(e);let r=s().$implicit;return C(r.academicLevelId,t)||(r.academicLevelId=t),u(t)}),l()}if(n&2){let e=s().$implicit,o=s();K(S(4,Di)),v("ngModel",e.academicLevelId),d("options",o.academicLevelData)}}function Ui(n,i){if(n&1&&f(0,"p-tag",26),n&2){let e=s().$implicit,o=s();d("value",o.getAcademicLevelName(e.academicLevelId))}}function Ri(n,i){if(n&1){let e=y();a(0,"button",27),_("click",function(){c(e);let t=s().$implicit,r=s();return u(r.onRowEditInit(t))}),l()}}function Bi(n,i){if(n&1){let e=y();a(0,"button",28),_("click",function(){c(e);let t=s().$implicit,r=s();return u(r.onRowEditSave(t))}),l()}}function Wi(n,i){if(n&1){let e=y();a(0,"button",29),_("click",function(){c(e);let t=s(),r=t.$implicit,g=t.rowIndex,V=s();return u(V.onRowEditCancel(r,g))}),l()}}function zi(n,i){if(n&1){let e=y();a(0,"tr",16)(1,"td")(2,"p-cellEditor"),h(3,Ni,1,1,"ng-template",17)(4,Ai,1,1,"ng-template",18),l()(),a(5,"td")(6,"p-cellEditor"),h(7,Pi,1,5,"ng-template",17)(8,Ui,1,1,"ng-template",18),l()(),a(9,"td")(10,"div",19),h(11,Ri,1,0,"button",20)(12,Bi,1,0,"button",21)(13,Wi,1,0,"button",22),l()(),a(14,"td")(15,"div",19)(16,"button",23),_("click",function(){let t=c(e).$implicit,r=s();return u(r.confirmDelete(t))}),l()()()()}if(n&2){let e=i.$implicit,o=i.editing;d("pEditableRow",e),p(11),d("ngIf",!o),p(),d("ngIf",o),p(),d("ngIf",o)}}function Oi(n,i){n&1&&(a(0,"div",37),m(1,"\u0627\u0636\u0627\u0641\u0647 \u0641\u0635\u0644"),l())}function ji(n,i){if(n&1){let e=y();a(0,"div")(1,"p-dialog",30),x("visibleChange",function(t){c(e);let r=s();return C(r.visible,t)||(r.visible=t),u(t)}),h(2,Oi,2,0,"ng-template",11),a(3,"div",31)(4,"p-floatlabel",32)(5,"p-dropdown",8),x("ngModelChange",function(t){c(e);let r=s();return C(r.newChapter.academicLevelId,t)||(r.newChapter.academicLevelId=t),u(t)}),l(),a(6,"label",9),m(7,"\u0627\u0644\u0645\u0631\u062D\u0644\u0629 \u0627\u0644\u062F\u0631\u0627\u0633\u064A\u0629"),l()(),a(8,"p-floatlabel",33)(9,"input",4),x("ngModelChange",function(t){c(e);let r=s();return C(r.newChapter.chapterName,t)||(r.newChapter.chapterName=t),u(t)}),l(),a(10,"label",5),m(11," \u0627\u0633\u0645 \u0627\u0644\u0641\u0635\u0644 "),l()()(),a(12,"div",34)(13,"p-button",35),_("click",function(){c(e);let t=s();return u(t.visible=!1)}),l(),a(14,"p-button",36),_("click",function(){c(e);let t=s();return u(t.createChapter())}),l()()()()}if(n&2){let e=s();p(),K(S(7,Ei)),d("modal",!0),v("visible",e.visible),p(4),v("ngModel",e.newChapter.academicLevelId),d("options",e.academicLevelData),p(4),v("ngModel",e.newChapter.chapterName)}}var Ye=class n{constructor(i,e,o,t){this.tasksAndVideos=i;this.confirmationService=e;this.chapters=o;this.messageService=t;let r=sessionStorage.getItem("teacherId");r&&(this.teacherId=r)}teacherId;academicLevelData=[];Filter;Chapters=[];academicLevelId;clonedChapter={};statuses;visible=!1;newChapter;ngOnInit(){this.Filter={teacherId:this.teacherId,pageNumber:1,pageSize:25},this.getChapterData(),this.getAcademicLevelFilter()}getAcademicLevelFilter(){this.tasksAndVideos.getAllAcademicLevels().subscribe({next:i=>{this.academicLevelData=i}})}getChapterData(){this.chapters.getAllChapters(this.Filter).subscribe({next:i=>{this.Chapters=i.items},error:i=>{console.error("Error fetching teachers:",i)}})}onRowEditInit(i){i?.chapterID!==void 0&&(this.clonedChapter[i.chapterID]=Ze({},i))}onRowEditSave(i){if(i.chapterName&&i.chapterID&&i.academicLevelId){let e={chaptersID:i.chapterID,teacherId:i.teacherId,academicLevelId:i.academicLevelId,chapterName:i.chapterName};this.chapters.updateChapter(e).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"\u062A\u0645 \u0627\u0644\u062A\u062D\u062F\u064A\u062B",detail:"\u062A\u0645 \u062A\u0639\u062F\u064A\u0644 \u0627\u0644\u0641\u0635\u0644 \u0628\u0646\u062C\u0627\u062D"}),delete this.clonedChapter[i.chapterID]},error:()=>{this.messageService.add({severity:"error",summary:"\u062E\u0637\u0623",detail:"\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u062A\u0639\u062F\u064A\u0644"})}})}}onRowEditCancel(i,e){i?.chapterID!==void 0&&(this.Chapters[e]=this.clonedChapter[i.chapterID],delete this.clonedChapter[i.chapterID])}confirmDelete(i){this.confirmationService.confirm({message:`\u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F \u0645\u0646 \u062D\u0630\u0641  "${i.chapterName}"\u061F`,header:"\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u062D\u0630\u0641",icon:"pi pi-exclamation-triangle",acceptLabel:"\u0646\u0639\u0645",rejectLabel:"\u0625\u0644\u063A\u0627\u0621",accept:()=>{this.deleteChapter(i)}})}deleteChapter(i){i.chapterID&&this.chapters.deleteChapter(+i.chapterID).subscribe(()=>{this.Chapters=this.Chapters.filter(e=>e.chaptersID!==i.chapterID),this.messageService.add({severity:"success",summary:"\u062A\u0645 \u0627\u0644\u062D\u0630\u0641",detail:"\u062A\u0645 \u062D\u0630\u0641 \u0627\u0644\u0641\u0635\u0644 \u0628\u0646\u062C\u0627\u062D"})})}createChapter(){if(!this.newChapter||!this.newChapter.chapterName||this.newChapter.academicLevelId==null){this.messageService.add({severity:"error",summary:"\u062E\u0637\u0623",detail:"\u064A\u0631\u062C\u0649 \u0645\u0644\u0621 \u062C\u0645\u064A\u0639 \u0627\u0644\u062D\u0642\u0648\u0644 \u0627\u0644\u0645\u0637\u0644\u0648\u0628\u0629: \u0627\u0633\u0645 \u0627\u0644\u0641\u0635\u0644 \u0648 \u0627\u0644\u0645\u0631\u062D\u0644\u0629 \u0627\u0644\u062F\u0631\u0627\u0633\u064A\u0629.",life:3e3});return}this.chapters.createChapter({chapter:this.newChapter}).subscribe(()=>{this.messageService.add({severity:"success",summary:"\u062A\u0645 \u0627\u0644\u0625\u0636\u0627\u0641\u0629 \u0628\u0646\u062C\u0627\u062D",detail:"\u062A\u0645 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0641\u0635\u0644 \u0628\u0646\u062C\u0627\u062D.",life:3e3}),this.getChapterData()},()=>{this.messageService.add({severity:"error",summary:"\u062E\u0637\u0623 \u0641\u064A \u0627\u0644\u0625\u0636\u0627\u0641\u0629",detail:"\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0641\u0635\u0644.",life:3e3})})}getAcademicLevelName(i){let e=this.academicLevelData.find(o=>o.academicLevelID===i);return e?e.academicLevelName:"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641"}onFilterChange(){this.getChapterData()}showDialog(){this.visible=!0,this.newChapter={},this.newChapter={teacherId:this.teacherId}}static \u0275fac=function(e){return new(e||n)(w(D),w(X),w(ge),w(F))};static \u0275cmp=M({type:n,selectors:[["app-chapters"]],features:[B([F,X])],decls:18,vars:7,consts:[[1,"card"],["label","\u0625\u0636\u0627\u0641\u0629 \u0641\u0635\u0644","icon","pi pi-plus",1,"add-chapter-btn",3,"click"],[1,"filters-container"],["variant","on",1,"filter-item"],["pInputText","","id","taskName","autocomplete","off",2,"width","100%",3,"ngModelChange","ngModel"],["for","taskName",2,"font-size","large"],[1,"pi","pi-search"],["variant","on",1,"w-full","md:w-56","filter-item"],["inputId","academicLevel","optionLabel","academicLevelName","optionValue","academicLevelID","styleClass","w-full",3,"ngModelChange","ngModel","options"],["for","academicLevel",2,"font-size","large"],["dataKey","chaptersID","editMode","row",3,"value","tableStyle"],["pTemplate","header"],["pTemplate","body"],[4,"ngIf"],[2,"width","33%"],[2,"width","17%"],[3,"pEditableRow"],["pTemplate","input"],["pTemplate","output"],[1,"flex","items-center","justify-center","gap-2"],["pButton","","pRipple","","type","button","pInitEditableRow","","icon","pi pi-pencil","text","","rounded","","severity","secondary",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","pi pi-check","text","","rounded","","severity","success",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","pi pi-times","text","","rounded","","severity","danger",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","icon","pi pi-trash","text","","rounded","","severity","danger",3,"click"],["pInputText","","type","text",3,"ngModelChange","ngModel"],["optionLabel","academicLevelName","optionValue","academicLevelID","inputId","academicLevel","appendTo","body",3,"ngModelChange","ngModel","options"],[3,"value"],["pButton","","pRipple","","type","button","pInitEditableRow","","icon","pi pi-pencil","text","","rounded","","severity","secondary",3,"click"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","pi pi-check","text","","rounded","","severity","success",3,"click"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","pi pi-times","text","","rounded","","severity","danger",3,"click"],["header","\u0627\u0636\u0627\u0641\u0647 \u0641\u0635\u0644",3,"visibleChange","modal","visible"],[1,"flex","items-center","gap-4","mb-4","mt-4"],["variant","on",1,"w-full","md:w-56","filter-item",2,"margin-top","10px"],["variant","on",1,"filter-item",2,"margin-top","10px"],[1,"flex","justify-end","gap-2",2,"margin-top","200px"],["label","Cancel","severity","secondary",3,"click"],["label","Save","severity","success",3,"click"],[1,"custom-header"]],template:function(e,o){e&1&&(f(0,"p-toast")(1,"p-confirmDialog"),a(2,"div",0)(3,"p-button",1),_("click",function(){return o.showDialog()}),l(),a(4,"div",2)(5,"p-floatlabel",3)(6,"input",4),x("ngModelChange",function(r){return C(o.Filter.chapterName,r)||(o.Filter.chapterName=r),r}),_("ngModelChange",function(){return o.onFilterChange()}),l(),a(7,"label",5),f(8,"p-inputicon",6),m(9," \u0627\u0633\u0645 \u0627\u0644\u0641\u0635\u0644 "),l()(),a(10,"p-floatlabel",7)(11,"p-dropdown",8),x("ngModelChange",function(r){return C(o.Filter.academicLevelId,r)||(o.Filter.academicLevelId=r),r}),_("ngModelChange",function(){return o.onFilterChange()}),l(),a(12,"label",9),m(13,"\u0627\u0644\u0645\u0631\u062D\u0644\u0629 \u0627\u0644\u062F\u0631\u0627\u0633\u064A\u0629"),l()()(),a(14,"p-table",10),h(15,Li,7,0,"ng-template",11)(16,zi,17,4,"ng-template",12),l()(),h(17,ji,15,8,"div",13)),e&2&&(p(6),v("ngModel",o.Filter.chapterName),p(5),v("ngModel",o.Filter.academicLevelId),d("options",o.academicLevelData),p(3),d("value",o.Chapters)("tableStyle",S(6,Fi)),p(3),d("ngIf",o.visible))},dependencies:[ne,ie,le,pt,at,rt,lt,st,$,Z,T,Q,Ne,mt,Me,W,pe,de,R,U,P,L,N,A,O,z,te,ee,G,j,Pe,Ae,_e,ue],styles:[".filters-container[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:1rem}.filter-item[_ngcontent-%COMP%]{flex:1}.add-chapter-btn[_ngcontent-%COMP%]{position:absolute;top:5px;right:20px;font-size:2rem;padding:10px 20px;z-index:10}.card[_ngcontent-%COMP%]{position:relative;padding-top:60px}.custom-header[_ngcontent-%COMP%]{text-align:center;font-size:24px;font-weight:700}"]})};var Zo=[{path:"",component:ze,children:[{path:"",redirectTo:"tasks",pathMatch:"full"},{path:"tasks",component:Ue},{path:"videos",component:Oe},{path:"uploadTasks",component:je},{path:"uploadVideos",component:He},{path:"chapters",component:Ye}]},{path:"studentTasksDashboard",component:Ge},{path:"VideoPlayer",component:Ke}];export{Zo as default};
